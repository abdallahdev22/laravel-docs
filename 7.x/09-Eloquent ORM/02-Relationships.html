<!DOCTYPE html>
<html class="gr__laravel_com" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Eloquent: Relationships - Laravel - The PHP Framework For Web Artisans</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <link rel="canonical" href="https://laravel.com/docs/7.x/eloquent-relationships">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://laravel.com/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://laravel.com/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://laravel.com/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://laravel.com/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://laravel.com/img/favicon/safari-pinned-tab.svg" color="#ff2d20">
    <link rel="shortcut icon" href="https://laravel.com/img/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#ff2d20">
    <meta name="msapplication-config" content="/img/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Load fonts -->
    <link rel="stylesheet" href="02-Relationships_files/ins2wgm.css">

    <!-- Load styles -->
    <link rel="stylesheet" type="text/css" href="02-Relationships_files/app.css">

    <!-- Load JS -->
    <script src="02-Relationships_files/jquery.js"></script>

    <script id="_carbonads_projs" type="text/javascript" src="02-Relationships_files/CKYILK3E.json"></script>
</head>
<body class="language-php" data-gr-c-s-loaded="true">

<div class="sidebar_layout" id="docsScreen">

    <div class="page_contain">
        <div class="contain">
            <aside class="sidebar">
                <a href="../index.html" class="logo">
                    <img class="mark" src="../index_files/logomark.min.svg" alt="Laravel">
                    <img class="type" src="../index_files/logotype.min.svg" alt="Laravel">
                </a>
                <nav>
                    <div class="navigation_contain" style="display: block;">
                        <div class="docs_sidebar">
                            <ul>
                                <li>
                                    <h2>Prologue</h2>
                                    <ul>
                                        <li><a href="../01-Prologue/01-Release%20Notes.html">Release Notes</a></li>
                                        <li><a href="../01-Prologue/02-Upgrade%20Guide.html">Upgrade Guide</a></li>
                                        <li><a href="../01-Prologue/03-Contribution%20Guide.html">Contribution Guide</a>
                                        </li>
                                        <li><a href="https://laravel.com/api/7.x">API Documentation</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Getting Started</h2>
                                    <ul>
                                        <li><a href="../02-Getting%20Started/01-Installation.html">Installation</a></li>
                                        <li><a href="../02-Getting%20Started/02-Configuration.html">Configuration</a>
                                        </li>
                                        <li><a href="../02-Getting%20Started/03-Directory%20Structure.html">Directory
                                            Structure</a>
                                        </li>
                                        <li><a href="../02-Getting%20Started/04-Homestead.html">Homestead</a></li>
                                        <li><a href="../02-Getting%20Started/05-Valet.html">Valet</a></li>
                                        <li><a href="../02-Getting%20Started/06-Deployment.html">Deployment</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Architecture Concepts</h2>
                                    <ul>
                                        <li><a href="../03-Architecture%20Concepts/01-Request%20Lifecycle.html">Request
                                            Lifecycle</a></li>
                                        <li><a href="../03-Architecture%20Concepts/02-Service%20Container.html">Service
                                            Container</a></li>
                                        <li><a href="../03-Architecture%20Concepts/03-Service%20Providers.html">Service
                                            Providers</a></li>
                                        <li><a href="../03-Architecture%20Concepts/04-Facades.html">Facades</a></li>
                                        <li><a href="../03-Architecture%20Concepts/05-Contracts.html">Contracts</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>The Basics</h2>
                                    <ul>
                                        <li><a href="../04-The%20Basics/01-Routing.html">Routing</a></li>
                                        <li><a href="../04-The%20Basics/02-Middleware.html">Middleware</a></li>
                                        <li><a href="../04-The%20Basics/03-CSRF%20Protection.html">CSRF Protection</a>
                                        </li>
                                        <li><a href="../04-The%20Basics/04-Controllers.html">Controllers</a></li>
                                        <li><a href="../04-The%20Basics/05-Requests.html">Requests</a></li>
                                        <li><a href="../04-The%20Basics/06-Responses.html">Responses</a></li>
                                        <li><a href="../04-The%20Basics/07-Views.html">Views</a></li>
                                        <li><a href="../04-The%20Basics/08-URL%20Generation.html">URL Generation</a>
                                        </li>
                                        <li><a href="../04-The%20Basics/09-Session.html">Session</a></li>
                                        <li><a href="../04-The%20Basics/10-Validation.html">Validation</a></li>
                                        <li><a href="../04-The%20Basics/11-Error%20Handling.html">Error Handling</a>
                                        </li>
                                        <li><a href="../04-The%20Basics/12-Logging.html">Logging</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Frontend</h2>
                                    <ul>
                                        <li><a href="../05-Frontend/01-Blade%20Templates.html">Blade Templates</a></li>
                                        <li><a href="../05-Frontend/02-Localization.html">Localization</a></li>
                                        <li><a href="../05-Frontend/03-Frontend%20Scaffolding.html">Frontend
                                            Scaffolding</a></li>
                                        <li><a href="../05-Frontend/04-Compiling%20Assets.html">Compiling Assets</a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Security</h2>
                                    <ul>
                                        <li><a href="../06-Security/01-Authentication.html">Authentication</a></li>
                                        <li><a href="../06-Security/02-Authorization.html">Authorization</a></li>
                                        <li><a href="../06-Security/03-Email%20Verification.html">Email Verification</a>
                                        </li>
                                        <li><a href="../06-Security/04-Encryption.html">Encryption</a></li>
                                        <li><a href="../06-Security/05-Hashing.html">Hashing</a></li>
                                        <li><a href="../06-Security/06-Password%20Reset.html">Password Reset</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Digging Deeper</h2>
                                    <ul>
                                        <li><a href="../07-Digging%20Deeper/01-Artisan%20Console.html">Artisan
                                            Console</a></li>
                                        <li><a href="../07-Digging%20Deeper/02-Broadcasting.html">Broadcasting</a></li>
                                        <li><a href="../07-Digging%20Deeper/03-Cache.html">Cache</a></li>
                                        <li><a href="../07-Digging%20Deeper/04-Collections.html">Collections</a></li>
                                        <li><a href="../07-Digging%20Deeper/05-Events.html">Events</a></li>
                                        <li><a href="../07-Digging%20Deeper/06-File%20Storage.html">File Storage</a>
                                        </li>
                                        <li><a href="../07-Digging%20Deeper/07-Helpers.html">Helpers</a></li>
                                        <li><a href="../07-Digging%20Deeper/08-HTTP%20Client.html">HTTP Client</a></li>
                                        <li><a href="../07-Digging%20Deeper/09-Mail.html">Mail</a></li>
                                        <li><a href="../07-Digging%20Deeper/10-Notifications.html">Notifications</a>
                                        </li>
                                        <li><a href="../07-Digging%20Deeper/11-Package%20Development.html">Package
                                            Development</a>
                                        </li>
                                        <li><a href="../07-Digging%20Deeper/12-Queues.html">Queues</a></li>
                                        <li><a href="../07-Digging%20Deeper/13-Task%20Scheduling.html">Task
                                            Scheduling</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Database</h2>
                                    <ul>
                                        <li><a href="../08-Database/01-Getting%20Started.html">Getting Started</a></li>
                                        <li><a href="../08-Database/02-Query%20Builder.html">Query Builder</a></li>
                                        <li><a href="../08-Database/03-Pagination.html">Pagination</a></li>
                                        <li><a href="../08-Database/04-Migrations.html">Migrations</a></li>
                                        <li><a href="../08-Database/05-Seeding.html">Seeding</a></li>
                                        <li><a href="../08-Database/06-Redis.html">Redis</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Eloquent ORM</h2>
                                    <ul>
                                        <li><a href="../09-Eloquent%20ORM/01-Getting%20Started.html">Getting Started</a>
                                        </li>
                                        <li><a href="../09-Eloquent%20ORM/02-Relationships.html">Relationships</a></li>
                                        <li><a href="../09-Eloquent%20ORM/03-Collections.html">Collections</a></li>
                                        <li><a href="../09-Eloquent%20ORM/04-Mutators.html">Mutators</a></li>
                                        <li><a href="../09-Eloquent%20ORM/05-API%20Resources.html">API Resources</a>
                                        </li>
                                        <li><a href="../09-Eloquent%20ORM/06-Serialization.html">Serialization</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Testing</h2>
                                    <ul>
                                        <li><a href="../10-Testing/01-Getting%20Started.html">Getting Started</a></li>
                                        <li><a href="../10-Testing/02-HTTP%20Tests.html">HTTP Tests</a></li>
                                        <li><a href="../10-Testing/03-Console%20Tests.html">Console Tests</a></li>
                                        <li><a href="../10-Testing/04-Browser%20Tests.html">Browser Tests</a></li>
                                        <li><a href="../10-Testing/05-Database.html">Database</a></li>
                                        <li><a href="../10-Testing/06-Mocking.html">Mocking</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Official Packages</h2>
                                    <ul>
                                        <li><a href="../11-Official%20Packages/01-Cashier.html">Cashier (Stripe)</a>
                                        </li>
                                        <li><a href="https://github.com/laravel/cashier-mollie">Cashier (Mollie)</a>
                                        </li>
                                        <li><a href="../11-Official%20Packages/02-Dusk.html">Dusk</a></li>
                                        <li><a href="../11-Official%20Packages/03-Envoy.html">Envoy</a></li>
                                        <li><a href="../11-Official%20Packages/04-Horizon.html">Horizon</a></li>
                                        <li><a href="../11-Official%20Packages/05-Passport.html">Passport</a></li>
                                        <li><a href="../11-Official%20Packages/06-Sanctum.html">Sanctum</a></li>
                                        <li><a href="../11-Official%20Packages/07-Scout.html">Scout</a></li>
                                        <li><a href="../11-Official%20Packages/08-Socialite.html">Socialite</a></li>
                                        <li><a href="../11-Official%20Packages/09-Telescope.html">Telescope</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
                <div class="trigger_contain">
                    <a href="#" class="nav_trigger" aria-label="Menu">
                        <div class="bar"></div>
                    </a>
                </div>
            </aside>

            <section class="body_content">
                <section class="docs_body">
                    <section class="docs_main">
                        <h1>Eloquent: Relationships</h1>
                        <ul>
                            <li><a href="#introduction">Introduction</a></li>
                            <li><a href="#defining-relationships">Defining Relationships</a>
                                <ul>
                                    <li><a href="#one-to-one">One To One</a></li>
                                    <li><a href="#one-to-many">One To Many</a></li>
                                    <li><a href="#one-to-many-inverse">One To Many (Inverse)</a></li>
                                    <li><a href="#many-to-many">Many To Many</a></li>
                                    <li><a href="#defining-custom-intermediate-table-models">Defining Custom
                                        Intermediate Table Models</a></li>
                                    <li><a href="#has-one-through">Has One Through</a></li>
                                    <li><a href="#has-many-through">Has Many Through</a></li>
                                </ul>
                            </li>
                            <li><a href="#polymorphic-relationships">Polymorphic Relationships</a>
                                <ul>
                                    <li><a href="#one-to-one-polymorphic-relations">One To One</a></li>
                                    <li><a href="#one-to-many-polymorphic-relations">One To Many</a></li>
                                    <li><a href="#many-to-many-polymorphic-relations">Many To Many</a></li>
                                    <li><a href="#custom-polymorphic-types">Custom Polymorphic Types</a></li>
                                </ul>
                            </li>
                            <li><a href="#querying-relations">Querying Relations</a>
                                <ul>
                                    <li><a href="#relationship-methods-vs-dynamic-properties">Relationship Methods Vs.
                                        Dynamic Properties</a></li>
                                    <li><a href="#querying-relationship-existence">Querying Relationship Existence</a>
                                    </li>
                                    <li><a href="#querying-relationship-absence">Querying Relationship Absence</a></li>
                                    <li><a href="#querying-polymorphic-relationships">Querying Polymorphic
                                        Relationships</a></li>
                                    <li><a href="#counting-related-models">Counting Related Models</a></li>
                                </ul>
                            </li>
                            <li><a href="#eager-loading">Eager Loading</a>
                                <ul>
                                    <li><a href="#constraining-eager-loads">Constraining Eager Loads</a></li>
                                    <li><a href="#lazy-eager-loading">Lazy Eager Loading</a></li>
                                </ul>
                            </li>
                            <li><a href="#inserting-and-updating-related-models">Inserting &amp; Updating Related
                                Models</a>
                                <ul>
                                    <li><a href="#the-save-method">The <code class=" language-php">save</code>
                                        Method</a></li>
                                    <li><a href="#the-create-method">The <code class=" language-php">create</code>
                                        Method</a></li>
                                    <li><a href="#updating-belongs-to-relationships">Belongs To Relationships</a></li>
                                    <li><a href="#updating-many-to-many-relationships">Many To Many Relationships</a>
                                    </li>
                                </ul>
                            </li>
                            <li><a href="#touching-parent-timestamps">Touching Parent Timestamps</a></li>
                        </ul>
                        <p><a name="introduction"></a></p>
                        <h2 id="introduction"><a href="#introduction">Introduction</a></h2>
                        <p>Database tables are often related to one another. For example, a blog
                            post may have many comments, or an order could be related to the user
                            who placed it. Eloquent makes managing and working with these
                            relationships easy, and supports several different types of
                            relationships:</p>
                        <div class="content-list">
                            <ul>
                                <li><a href="#one-to-one">One To One</a></li>
                                <li><a href="#one-to-many">One To Many</a></li>
                                <li><a href="#many-to-many">Many To Many</a></li>
                                <li><a href="#has-one-through">Has One Through</a></li>
                                <li><a href="#has-many-through">Has Many Through</a></li>
                                <li><a href="#one-to-one-polymorphic-relations">One To One (Polymorphic)</a></li>
                                <li><a href="#one-to-many-polymorphic-relations">One To Many (Polymorphic)</a></li>
                                <li><a href="#many-to-many-polymorphic-relations">Many To Many (Polymorphic)</a></li>
                            </ul>
                        </div>
                        <p><a name="defining-relationships"></a></p>
                        <h2 id="defining-relationships"><a href="#defining-relationships">Defining Relationships</a>
                        </h2>
                        <p>Eloquent relationships are defined as methods on your Eloquent model
                            classes. Since, like Eloquent models themselves, relationships also
                            serve as powerful <a href="https://laravel.com/docs/7.x/queries">query builders</a>,
                            defining relationships as methods provides powerful method chaining and
                            querying capabilities. For example, we may chain additional constraints
                            on this <code class=" language-php">posts</code> relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">posts</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">where</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'active'</span><span
                                class="token punctuation">,</span> <span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p>But, before diving too deep into using relationships, let's learn how to define each
                            type.</p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="02-Relationships_files/exclamation.svg"></div>
                                <p class="content">
                                    Relationship names cannot collide with attribute names as that could
                                    lead to your model not being able to know which one to resolve.</p></div>
                        </blockquote>
                        <p><a name="one-to-one"></a></p>
                        <h3 id="one-to-one"><a href="#one-to-one">One To One</a></h3>
                        <p>A one-to-one relationship is a very basic relation. For example, a <code
                                class=" language-php">User</code> model might be associated with one <code
                                class=" language-php">Phone</code>. To define this relationship, we place a <code
                                class=" language-php">phone</code> method on the <code class=" language-php">User</code>
                            model. The <code class=" language-php">phone</code> method should call the <code
                                    class=" language-php">hasOne</code> method and return its result:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the phone record associated with the user.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">phone</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hasOne</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Phone'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>The first argument passed to the <code class=" language-php">hasOne</code>
                            method is the name of the related model. Once the relationship is
                            defined, we may retrieve the related record using Eloquent's dynamic
                            properties. Dynamic properties allow you to access relationship methods
                            as if they were properties defined on the model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$phone</span> <span class="token operator">=</span> User<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token property">phone</span><span class="token punctuation">;</span></code></pre>
                        <p>Eloquent determines the foreign key of the relationship based on the model name. In this
                            case, the <code class=" language-php">Phone</code> model is automatically assumed to have a
                            <code class=" language-php">user_id</code> foreign key. If you wish to override this
                            convention, you may pass a second argument to the <code class=" language-php">hasOne</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">hasOne</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Phone'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>Additionally, Eloquent assumes that the foreign key should have a value matching the <code
                                class=" language-php">id</code> (or the custom <code class=" language-php"><span
                                class="token variable">$primaryKey</span></code>) column of the parent. In other words,
                            Eloquent will look for the value of the user's <code class=" language-php">id</code> column
                            in the <code class=" language-php">user_id</code> column of the <code class=" language-php">Phone</code>
                            record. If you would like the relationship to use a value other than <code
                                    class=" language-php">id</code>, you may pass a third argument to the <code
                                    class=" language-php">hasOne</code> method specifying your custom key:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">hasOne</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Phone'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'local_key'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Defining The Inverse Of The Relationship</h4>
                        <p>So, we can access the <code class=" language-php">Phone</code> model from our <code
                                class=" language-php">User</code>. Now, let's define a relationship on the <code
                                class=" language-php">Phone</code> model that will let us access the <code
                                class=" language-php">User</code> that owns the phone. We can define the inverse of a
                            <code class=" language-php">hasOne</code> relationship using the <code
                                    class=" language-php">belongsTo</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Phone</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the user that owns the phone.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">user</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">belongsTo</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>In the example above, Eloquent will try to match the <code
                                class=" language-php">user_id</code> from the <code class=" language-php">Phone</code>
                            model to an <code class=" language-php">id</code> on the <code
                                    class=" language-php">User</code>
                            model. Eloquent determines the default foreign key name by examining
                            the name of the relationship method and suffixing the method name with <code
                                    class=" language-php">_id</code>. However, if the foreign key on the <code
                                    class=" language-php">Phone</code> model is not <code
                                    class=" language-php">user_id</code>, you may pass a custom key name as the second
                            argument to the <code class=" language-php">belongsTo</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Get the user that owns the phone.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">user</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>If your parent model does not use <code class=" language-php">id</code> as its primary key,
                            or you wish to join the child model to a different column, you may pass a third argument to
                            the <code class=" language-php">belongsTo</code> method specifying your parent table's
                            custom key:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Get the user that owns the phone.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">user</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'other_key'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="one-to-many"></a></p>
                        <h3 id="one-to-many"><a href="#one-to-many">One To Many</a></h3>
                        <p>A one-to-many relationship is used to define relationships where a
                            single model owns any amount of other models. For example, a blog post
                            may have an infinite number of comments. Like all other Eloquent
                            relationships, one-to-many relationships are defined by placing a
                            function on your Eloquent model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Post</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the comments for the blog post.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hasMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Comment'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Remember, Eloquent will automatically determine the proper foreign key column on the <code
                                class=" language-php">Comment</code> model. By convention, Eloquent will take the "snake
                            case" name of the owning model and suffix it with <code class=" language-php">_id</code>.
                            So, for this example, Eloquent will assume the foreign key on the <code
                                    class=" language-php">Comment</code> model is <code
                                    class=" language-php">post_id</code>.</p>
                        <p>Once the relationship has been defined, we can access the collection of comments by accessing
                            the <code class=" language-php">comments</code>
                            property. Remember, since Eloquent provides "dynamic properties", we
                            can access relationship methods as if they were defined as properties on
                            the model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$comments</span> <span class="token operator">=</span> App\<span
                                class="token package">Post</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token property">comments</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$comments</span> <span
                                    class="token keyword">as</span> <span class="token variable">$comment</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Since all relationships also serve as query builders, you can add
                            further constraints to which comments are retrieved by calling the <code
                                    class=" language-php">comments</code> method and continuing to chain conditions onto
                            the query:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$comment</span> <span class="token operator">=</span> App\<span
                                class="token package">Post</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">comments</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">where</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'title'</span><span class="token punctuation">,</span> <span
                                class="token single-quoted-string string">'foo'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">first</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p>Like the <code class=" language-php">hasOne</code> method, you may also override the foreign
                            and local keys by passing additional arguments to the <code
                                    class=" language-php">hasMany</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">hasMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Comment'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hasMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Comment'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'local_key'</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="one-to-many-inverse"></a></p>
                        <h3 id="one-to-many-inverse"><a href="#one-to-many-inverse">One To Many (Inverse)</a></h3>
                        <p>Now that we can access all of a post's comments, let's define a
                            relationship to allow a comment to access its parent post. To define the
                            inverse of a <code class=" language-php">hasMany</code> relationship, define a relationship
                            function on the child model which calls the <code class=" language-php">belongsTo</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Comment</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the post that owns the comment.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">belongsTo</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Once the relationship has been defined, we can retrieve the <code
                                class=" language-php">Post</code> model for a <code class=" language-php">Comment</code>
                            by accessing the <code class=" language-php">post</code> "dynamic property":</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$comment</span> <span class="token operator">=</span> App\<span
                                class="token package">Comment</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$comment</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">title</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>In the example above, Eloquent will try to match the <code
                                class=" language-php">post_id</code> from the <code class=" language-php">Comment</code>
                            model to an <code class=" language-php">id</code> on the <code
                                    class=" language-php">Post</code>
                            model. Eloquent determines the default foreign key name by examining
                            the name of the relationship method and suffixing the method name with a
                            <code class=" language-php"><span class="token constant">_</span></code> followed by the
                            name of the primary key column. However, if the foreign key on the <code
                                    class=" language-php">Comment</code> model is not <code class=" language-php">post_id</code>,
                            you may pass a custom key name as the second argument to the <code class=" language-php">belongsTo</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Get the post that owns the comment.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">post</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>If your parent model does not use <code class=" language-php">id</code> as its primary key,
                            or you wish to join the child model to a different column, you may pass a third argument to
                            the <code class=" language-php">belongsTo</code> method specifying your parent table's
                            custom key:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Get the post that owns the comment.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">post</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foreign_key'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'other_key'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="many-to-many"></a></p>
                        <h3 id="many-to-many"><a href="#many-to-many">Many To Many</a></h3>
                        <p>Many-to-many relations are slightly more complicated than <code
                                class=" language-php">hasOne</code> and <code class=" language-php">hasMany</code>
                            relationships. An example of such a relationship is a user with many
                            roles, where the roles are also shared by other users. For example, many
                            users may have the role of "Admin". </p>
                        <h4>Table Structure</h4>
                        <p>To define this relationship, three database tables are needed: <code class=" language-php">users</code>,
                            <code class=" language-php">roles</code>, and <code class=" language-php">role_user</code>.
                            The <code class=" language-php">role_user</code> table is derived from the alphabetical
                            order of the related model names, and contains the <code
                                    class=" language-php">user_id</code> and <code class=" language-php">role_id</code>
                            columns:</p>
                        <pre class=" language-php"><code class=" language-php">users
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

roles
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

role_user
    user_id <span class="token operator">-</span> integer
    role_id <span class="token operator">-</span> integer</code></pre>
                        <h4>Model Structure</h4>
                        <p>Many-to-many relationships are defined by writing a method that returns the result of the
                            <code class=" language-php">belongsToMany</code> method. For example, let's define the <code
                                    class=" language-php">roles</code> method on our <code
                                    class=" language-php">User</code> model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The roles that belong to the user.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">belongsToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Once the relationship is defined, you may access the user's roles using the <code
                                class=" language-php">roles</code> dynamic property:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">roles</span> <span
                                    class="token keyword">as</span> <span class="token variable">$role</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Like all other relationship types, you may call the <code class=" language-php">roles</code>
                            method to continue chaining query constraints onto the relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$roles</span> <span class="token operator">=</span> App\<span
                                class="token package">User</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">roles</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">orderBy</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'name'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p>As mentioned previously, to determine the table name of the
                            relationship's joining table, Eloquent will join the two related model
                            names in alphabetical order. However, you are free to override this
                            convention. You may do so by passing a second argument to the <code class=" language-php">belongsToMany</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">belongsToMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'role_user'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>In addition to customizing the name of the joining table, you may
                            also customize the column names of the keys on the table by passing
                            additional arguments to the <code class=" language-php">belongsToMany</code>
                            method. The third argument is the foreign key name of the model on
                            which you are defining the relationship, while the fourth argument is
                            the foreign key name of the model that you are joining to:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">belongsToMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'role_user'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'user_id'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'role_id'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Defining The Inverse Of The Relationship</h4>
                        <p>To define the inverse of a many-to-many relationship, you place another call to <code
                                class=" language-php">belongsToMany</code> on your related model. To continue our user
                            roles example, let's define the <code class=" language-php">users</code> method on the <code
                                    class=" language-php">Role</code> model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Role</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The users that belong to the role.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">users</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">belongsToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>As you can see, the relationship is defined exactly the same as its <code
                                class=" language-php">User</code> counterpart, with the exception of referencing the
                            <code class=" language-php">App\<span class="token package">User</span></code> model. Since
                            we're reusing the <code class=" language-php">belongsToMany</code>
                            method, all of the usual table and key customization options are
                            available when defining the inverse of many-to-many relationships.</p>
                        <h4>Retrieving Intermediate Table Columns</h4>
                        <p>As you have already learned, working with many-to-many relations
                            requires the presence of an intermediate table. Eloquent provides some
                            very helpful ways of interacting with this table. For example, let's
                            assume our <code class=" language-php">User</code> object has many <code
                                    class=" language-php">Role</code> objects that it is related to. After accessing
                            this relationship, we may access the intermediate table using the <code
                                    class=" language-php">pivot</code> attribute on the models:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">roles</span> <span
                                    class="token keyword">as</span> <span class="token variable">$role</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$role</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">pivot</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token property">created_at</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Notice that each <code class=" language-php">Role</code> model we retrieve is automatically
                            assigned a <code class=" language-php">pivot</code> attribute. This attribute contains a
                            model representing the intermediate table, and may be used like any other Eloquent model.
                        </p>
                        <p>By default, only the model keys will be present on the <code
                                class=" language-php">pivot</code> object. If your pivot table contains extra
                            attributes, you must specify them when defining the relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">belongsToMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">withPivot</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'column1'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'column2'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>If you want your pivot table to have automatically maintained <code class=" language-php">created_at</code>
                            and <code class=" language-php">updated_at</code> timestamps, use the <code
                                    class=" language-php">withTimestamps</code> method on the relationship definition:
                        </p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">belongsToMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span
                                class="token function">withTimestamps</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <h4>Customizing The <code class=" language-php">pivot</code> Attribute Name</h4>
                        <p>As noted earlier, attributes from the intermediate table may be accessed on models using the
                            <code class=" language-php">pivot</code> attribute. However, you are free to customize the
                            name of this attribute to better reflect its purpose within your application.</p>
                        <p>For example, if your application contains users that may subscribe to
                            podcasts, you probably have a many-to-many relationship between users
                            and podcasts. If this is the case, you may wish to rename your
                            intermediate table accessor to <code class=" language-php">subscription</code> instead of
                            <code class=" language-php">pivot</code>. This can be done using the <code
                                    class=" language-php"><span class="token keyword">as</span></code> method when
                            defining the relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">belongsToMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Podcast'</span><span
                                class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token keyword">as</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'subscription'</span><span
                                    class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">withTimestamps</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>Once this is done, you may access the intermediate table data using the customized name:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$users</span> <span class="token operator">=</span> User<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">with</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'podcasts'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$users</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">flatMap</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">podcasts</span> <span class="token keyword">as</span> <span
                                    class="token variable">$podcast</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$podcast</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">subscription</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token property">created_at</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <h4>Filtering Relationships Via Intermediate Table Columns</h4>
                        <p>You can also filter the results returned by <code class=" language-php">belongsToMany</code>
                            using the <code class=" language-php">wherePivot</code>, <code class=" language-php">wherePivotIn</code>,
                            and <code class=" language-php">wherePivotNotIn</code> methods when defining the
                            relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span
                                class="token variable">$this</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">belongsToMany</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">wherePivot</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'approved'</span><span
                                class="token punctuation">,</span> <span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">belongsToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">wherePivotIn</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'priority'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span><span
                                    class="token number">1</span><span class="token punctuation">,</span> <span
                                    class="token number">2</span><span class="token punctuation">]</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">belongsToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Role'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">wherePivotNotIn</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'priority'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span><span
                                    class="token number">1</span><span class="token punctuation">,</span> <span
                                    class="token number">2</span><span class="token punctuation">]</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="defining-custom-intermediate-table-models"></a></p>
                        <h3 id="defining-custom-intermediate-table-models"><a
                                href="#defining-custom-intermediate-table-models">Defining Custom Intermediate Table
                            Models</a></h3>
                        <p>If you would like to define a custom model to represent the intermediate table of your
                            relationship, you may call the <code class=" language-php">using</code> method when defining
                            the relationship. Custom many-to-many pivot models should extend the <code
                                    class=" language-php">Illuminate\<span class="token package">Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Relations<span
                                    class="token punctuation">\</span>Pivot</span></code> class while custom polymorphic
                            many-to-many pivot models should extend the <code class=" language-php">Illuminate\<span
                                    class="token package">Database<span class="token punctuation">\</span>Eloquent<span
                                    class="token punctuation">\</span>Relations<span class="token punctuation">\</span>MorphPivot</span></code>
                            class. For example, we may define a <code class=" language-php">Role</code> which uses a
                            custom <code class=" language-php">RoleUser</code> pivot model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Role</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The users that belong to the role.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">users</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">belongsToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">using</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\RoleUser'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>When defining the <code class=" language-php">RoleUser</code> model, we will extend the <code
                                class=" language-php">Pivot</code> class:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Relations<span
                                    class="token punctuation">\</span>Pivot</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RoleUser</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Pivot</span>
<span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>You can combine <code class=" language-php">using</code> and <code class=" language-php">withPivot</code>
                            in order to retrieve columns from the intermediate table. For example, you may retrieve the
                            <code class=" language-php">created_by</code> and <code
                                    class=" language-php">updated_by</code> columns from the <code
                                    class=" language-php">RoleUser</code> pivot table by passing the column names to the
                            <code class=" language-php">withPivot</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Role</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The users that belong to the role.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">users</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">belongsToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span>
                        <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">using</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\RoleUser'</span><span
                                    class="token punctuation">)</span>
                        <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">withPivot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span>
                            <span class="token single-quoted-string string">'created_by'</span><span
                                    class="token punctuation">,</span>
                            <span class="token single-quoted-string string">'updated_by'</span><span
                                    class="token punctuation">,</span>
                        <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <blockquote>
                            <p><strong>Note:</strong> Pivot models may not use the <code class=" language-php">SoftDeletes</code>
                                trait. If you need to soft delete pivot records consider converting your pivot model to
                                an actual Eloquent model.</p>
                        </blockquote>
                        <h4>Custom Pivot Models And Incrementing IDs</h4>
                        <p>If you have defined a many-to-many relationship that uses a custom
                            pivot model, and that pivot model has an auto-incrementing primary key,
                            you should ensure your custom pivot model class defines an <code class=" language-php">incrementing</code>
                            property that is set to <code class=" language-php"><span class="token boolean constant">true</span></code>.
                        </p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Indicates if the IDs are auto-incrementing.
 *
 * @var bool
 */</span>
<span class="token keyword">public</span> <span class="token variable">$incrementing</span> <span
                                    class="token operator">=</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="has-one-through"></a></p>
                        <h3 id="has-one-through"><a href="#has-one-through">Has One Through</a></h3>
                        <p>The "has-one-through" relationship links models through a single
                            intermediate relation.
                            For example, if each supplier has one user, and each user is associated
                            with one user history record, then the supplier model may access the
                            user's history <em>through</em> the user. Let's look at the database tables necessary to
                            define this relationship:</p>
                        <pre class=" language-php"><code class=" language-php">users
    id <span class="token operator">-</span> integer
    supplier_id <span class="token operator">-</span> integer

suppliers
    id <span class="token operator">-</span> integer

history
    id <span class="token operator">-</span> integer
    user_id <span class="token operator">-</span> integer</code></pre>
                        <p>Though the <code class=" language-php">history</code> table does not contain a <code
                                class=" language-php">supplier_id</code> column, the <code class=" language-php">hasOneThrough</code>
                            relation can provide access to the user's history to the supplier
                            model. Now that we have examined the table structure for the
                            relationship, let's define it on the <code class=" language-php">Supplier</code> model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Supplier</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the user's history.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">userHistory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">hasOneThrough</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\History'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>The first argument passed to the <code class=" language-php">hasOneThrough</code> method is
                            the name of the final model we wish to access, while the second argument is the name of the
                            intermediate model.</p>
                        <p>Typical Eloquent foreign key conventions will be used when performing
                            the relationship's queries. If you would like to customize the keys of
                            the relationship, you may pass them as the third and fourth arguments to
                            the <code class=" language-php">hasOneThrough</code> method. The third
                            argument is the name of the foreign key on the intermediate model. The
                            fourth argument is the name of the foreign key on the final model. The
                            fifth argument is the local key, while the sixth argument is the local
                            key of the intermediate model:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">class</span> <span
                                class="token class-name">Supplier</span> <span
                                class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the user's history.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">userHistory</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">hasOneThrough</span><span class="token punctuation">(</span>
            <span class="token single-quoted-string string">'App\History'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'App\User'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'supplier_id'</span><span class="token punctuation">,</span> <span
                                    class="token comment">// Foreign key on users table...</span>
            <span class="token single-quoted-string string">'user_id'</span><span
                                    class="token punctuation">,</span> <span class="token comment">// Foreign key on history table...</span>
            <span class="token single-quoted-string string">'id'</span><span class="token punctuation">,</span> <span
                                    class="token comment">// Local key on suppliers table...</span>
            <span class="token single-quoted-string string">'id'</span> <span class="token comment">// Local key on users table...</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="has-many-through"></a></p>
                        <h3 id="has-many-through"><a href="#has-many-through">Has Many Through</a></h3>
                        <p>The "has-many-through" relationship provides a convenient shortcut
                            for accessing distant relations via an intermediate relation. For
                            example, a <code class=" language-php">Country</code> model might have many <code
                                    class=" language-php">Post</code> models through an intermediate <code
                                    class=" language-php">User</code>
                            model. In this example, you could easily gather all blog posts for a
                            given country. Let's look at the tables required to define this
                            relationship:</p>
                        <pre class=" language-php"><code class=" language-php">countries
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

users
    id <span class="token operator">-</span> integer
    country_id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

posts
    id <span class="token operator">-</span> integer
    user_id <span class="token operator">-</span> integer
    title <span class="token operator">-</span> string</code></pre>
                        <p>Though <code class=" language-php">posts</code> does not contain a <code
                                class=" language-php">country_id</code> column, the <code class=" language-php">hasManyThrough</code>
                            relation provides access to a country's posts via <code class=" language-php"><span
                                    class="token variable">$country</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">posts</span></code>.
                            To perform this query, Eloquent inspects the <code class=" language-php">country_id</code>
                            on the intermediate <code class=" language-php">users</code> table. After finding the
                            matching user IDs, they are used to query the <code class=" language-php">posts</code>
                            table.</p>
                        <p>Now that we have examined the table structure for the relationship, let's define it on the
                            <code class=" language-php">Country</code> model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Country</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get all of the posts for the country.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">posts</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hasManyThrough</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>The first argument passed to the <code class=" language-php">hasManyThrough</code> method is
                            the name of the final model we wish to access, while the second argument is the name of the
                            intermediate model.</p>
                        <p>Typical Eloquent foreign key conventions will be used when performing
                            the relationship's queries. If you would like to customize the keys of
                            the relationship, you may pass them as the third and fourth arguments to
                            the <code class=" language-php">hasManyThrough</code> method. The third
                            argument is the name of the foreign key on the intermediate model. The
                            fourth argument is the name of the foreign key on the final model. The
                            fifth argument is the local key, while the sixth argument is the local
                            key of the intermediate model:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">class</span> <span
                                class="token class-name">Country</span> <span class="token keyword">extends</span> <span
                                class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">posts</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hasManyThrough</span><span
                                    class="token punctuation">(</span>
            <span class="token single-quoted-string string">'App\Post'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'App\User'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'country_id'</span><span class="token punctuation">,</span> <span
                                    class="token comment">// Foreign key on users table...</span>
            <span class="token single-quoted-string string">'user_id'</span><span
                                    class="token punctuation">,</span> <span class="token comment">// Foreign key on posts table...</span>
            <span class="token single-quoted-string string">'id'</span><span class="token punctuation">,</span> <span
                                    class="token comment">// Local key on countries table...</span>
            <span class="token single-quoted-string string">'id'</span> <span class="token comment">// Local key on users table...</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="polymorphic-relationships"></a></p>
                        <h2 id="polymorphic-relationships"><a href="#polymorphic-relationships">Polymorphic
                            Relationships</a></h2>
                        <p>A polymorphic relationship allows the target model to belong to more than one type of model
                            using a single association.</p>
                        <p><a name="one-to-one-polymorphic-relations"></a></p>
                        <h3 id="one-to-one-polymorphic-relations"><a href="#one-to-one-polymorphic-relations">One To One
                            (Polymorphic)</a></h3>
                        <h4>Table Structure</h4>
                        <p>A one-to-one polymorphic relation is similar to a simple one-to-one
                            relation; however, the target model can belong to more than one type of
                            model on a single association. For example, a blog <code class=" language-php">Post</code>
                            and a <code class=" language-php">User</code> may share a polymorphic relation to an <code
                                    class=" language-php">Image</code>
                            model. Using a one-to-one polymorphic relation allows you to have a
                            single list of unique images that are used for both blog posts and user
                            accounts. First, let's examine the table structure:</p>
                        <pre class=" language-php"><code class=" language-php">posts
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

users
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

images
    id <span class="token operator">-</span> integer
    url <span class="token operator">-</span> string
    imageable_id <span class="token operator">-</span> integer
    imageable_type <span class="token operator">-</span> string</code></pre>
                        <p>Take note of the <code class=" language-php">imageable_id</code> and <code
                                class=" language-php">imageable_type</code> columns on the <code class=" language-php">images</code>
                            table. The <code class=" language-php">imageable_id</code> column will contain the ID value
                            of the post or user, while the <code class=" language-php">imageable_type</code> column will
                            contain the class name of the parent model. The <code
                                    class=" language-php">imageable_type</code> column is used by Eloquent to determine
                            which "type" of parent model to return when accessing the <code class=" language-php">imageable</code>
                            relation.</p>
                        <h4>Model Structure</h4>
                        <p>Next, let's examine the model definitions needed to build this relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Image</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the owning imageable model.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">imageable</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphTo</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Post</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the post's image.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">image</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphOne</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Image'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'imageable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the user's image.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">image</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphOne</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Image'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'imageable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <h4>Retrieving The Relationship</h4>
                        <p>Once your database table and models are defined, you may access the
                            relationships via your models. For example, to retrieve the image for a
                            post, we can use the <code class=" language-php">image</code> dynamic property:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$image</span> <span class="token operator">=</span> <span
                                    class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">image</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>You may also retrieve the parent from the polymorphic model by accessing the name of the
                            method that performs the call to <code class=" language-php">morphTo</code>. In our case,
                            that is the <code class=" language-php">imageable</code> method on the <code
                                    class=" language-php">Image</code> model. So, we will access that method as a
                            dynamic property:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$image</span> <span class="token operator">=</span> App\<span
                                class="token package">Image</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$imageable</span> <span class="token operator">=</span> <span
                                    class="token variable">$image</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">imageable</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>The <code class=" language-php">imageable</code> relation on the <code class=" language-php">Image</code>
                            model will return either a <code class=" language-php">Post</code> or <code
                                    class=" language-php">User</code> instance, depending on which type of model owns
                            the image.</p>
                        <p><a name="one-to-many-polymorphic-relations"></a></p>
                        <h3 id="one-to-many-polymorphic-relations"><a href="#one-to-many-polymorphic-relations">One To
                            Many (Polymorphic)</a></h3>
                        <h4>Table Structure</h4>
                        <p>A one-to-many polymorphic relation is similar to a simple one-to-many
                            relation; however, the target model can belong to more than one type of
                            model on a single association. For example, imagine users of your
                            application can "comment" on both posts and videos. Using polymorphic
                            relationships, you may use a single <code class=" language-php">comments</code> table for
                            both of these scenarios. First, let's examine the table structure required to build this
                            relationship:</p>
                        <pre class=" language-php"><code class=" language-php">posts
    id <span class="token operator">-</span> integer
    title <span class="token operator">-</span> string
    body <span class="token operator">-</span> text

videos
    id <span class="token operator">-</span> integer
    title <span class="token operator">-</span> string
    url <span class="token operator">-</span> string

comments
    id <span class="token operator">-</span> integer
    body <span class="token operator">-</span> text
    commentable_id <span class="token operator">-</span> integer
    commentable_type <span class="token operator">-</span> string</code></pre>
                        <h4>Model Structure</h4>
                        <p>Next, let's examine the model definitions needed to build this relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Comment</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the owning commentable model.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">commentable</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphTo</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Post</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get all of the post's comments.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Comment'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'commentable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Video</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get all of the video's comments.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Comment'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'commentable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <h4>Retrieving The Relationship</h4>
                        <p>Once your database table and models are defined, you may access the
                            relationships via your models. For example, to access all of the
                            comments for a post, we can use the <code class=" language-php">comments</code> dynamic
                            property:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">comments</span> <span
                                    class="token keyword">as</span> <span class="token variable">$comment</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
                        <p>You may also retrieve the owner of a polymorphic relation from the
                            polymorphic model by accessing the name of the method that performs the
                            call to <code class=" language-php">morphTo</code>. In our case, that is the <code
                                    class=" language-php">commentable</code> method on the <code class=" language-php">Comment</code>
                            model. So, we will access that method as a dynamic property:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$comment</span> <span class="token operator">=</span> App\<span
                                class="token package">Comment</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$commentable</span> <span class="token operator">=</span> <span class="token variable">$comment</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">commentable</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>The <code class=" language-php">commentable</code> relation on the <code
                                class=" language-php">Comment</code> model will return either a <code
                                class=" language-php">Post</code> or <code class=" language-php">Video</code> instance,
                            depending on which type of model owns the comment.</p>
                        <p><a name="many-to-many-polymorphic-relations"></a></p>
                        <h3 id="many-to-many-polymorphic-relations"><a href="#many-to-many-polymorphic-relations">Many
                            To Many (Polymorphic)</a></h3>
                        <h4>Table Structure</h4>
                        <p>Many-to-many polymorphic relations are slightly more complicated than <code
                                class=" language-php">morphOne</code> and <code class=" language-php">morphMany</code>
                            relationships. For example, a blog <code class=" language-php">Post</code> and <code
                                    class=" language-php">Video</code> model could share a polymorphic relation to a
                            <code class=" language-php">Tag</code>
                            model. Using a many-to-many polymorphic relation allows you to have a
                            single list of unique tags that are shared across blog posts and videos.
                            First, let's examine the table structure:</p>
                        <pre class=" language-php"><code class=" language-php">posts
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

videos
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

tags
    id <span class="token operator">-</span> integer
    name <span class="token operator">-</span> string

taggables
    tag_id <span class="token operator">-</span> integer
    taggable_id <span class="token operator">-</span> integer
    taggable_type <span class="token operator">-</span> string</code></pre>
                        <h4>Model Structure</h4>
                        <p>Next, we're ready to define the relationships on the model. The <code class=" language-php">Post</code>
                            and <code class=" language-php">Video</code> models will both have a <code
                                    class=" language-php">tags</code> method that calls the <code class=" language-php">morphToMany</code>
                            method on the base Eloquent class:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Post</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get all of the tags for the post.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">tags</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">morphToMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Tag'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'taggable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <h4>Defining The Inverse Of The Relationship</h4>
                        <p>Next, on the <code class=" language-php">Tag</code> model, you should define a method for
                            each of its related models. So, for this example, we will define a <code
                                    class=" language-php">posts</code> method and a <code
                                    class=" language-php">videos</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Tag</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get all of the posts that are assigned this tag.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">posts</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">morphedByMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'taggable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Get all of the videos that are assigned this tag.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">videos</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">morphedByMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Video'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'taggable'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <h4>Retrieving The Relationship</h4>
                        <p>Once your database table and models are defined, you may access the
                            relationships via your models. For example, to access all of the tags
                            for a post, you can use the <code class=" language-php">tags</code> dynamic property:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">tags</span> <span
                                    class="token keyword">as</span> <span class="token variable">$tag</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
                        <p>You may also retrieve the owner of a polymorphic relation from the
                            polymorphic model by accessing the name of the method that performs the
                            call to <code class=" language-php">morphedByMany</code>. In our case, that is the <code
                                    class=" language-php">posts</code> or <code class=" language-php">videos</code>
                            methods on the <code class=" language-php">Tag</code> model. So, you will access those
                            methods as dynamic properties:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$tag</span> <span
                                class="token operator">=</span> App\<span class="token package">Tag</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$tag</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">videos</span> <span
                                    class="token keyword">as</span> <span class="token variable">$video</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="custom-polymorphic-types"></a></p>
                        <h3 id="custom-polymorphic-types"><a href="#custom-polymorphic-types">Custom Polymorphic
                            Types</a></h3>
                        <p>By default, Laravel will use the fully qualified class name to store
                            the type of the related model. For instance, given the one-to-many
                            example above where a <code class=" language-php">Comment</code> may belong to a <code
                                    class=" language-php">Post</code> or a <code class=" language-php">Video</code>, the
                            default <code class=" language-php">commentable_type</code> would be either <code
                                    class=" language-php">App\<span class="token package">Post</span></code> or <code
                                    class=" language-php">App\<span class="token package">Video</span></code>,
                            respectively. However, you may wish to decouple your database from your
                            application's internal structure. In that case, you may define a "morph
                            map" to instruct Eloquent to use a custom name for each model instead
                            of the class name:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Relations<span class="token punctuation">\</span>Relation</span><span
                                class="token punctuation">;</span>

Relation<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">morphMap</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'posts'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span>
    <span class="token single-quoted-string string">'videos'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'App\Video'</span><span
                                    class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>You may register the <code class=" language-php">morphMap</code> in the <code
                                class=" language-php">boot</code> function of your <code class=" language-php">AppServiceProvider</code>
                            or create a separate service provider if you wish. </p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="02-Relationships_files/exclamation.svg"></div>
                                <p class="content"> When adding a "morph map" to your existing application, every
                                    morphable <code class=" language-php"><span
                                            class="token operator">*</span>_type</code> column value in your database
                                    that still contains a fully-qualified class will need to be converted to its "map"
                                    name.</p></div>
                        </blockquote>
                        <p>You may determine the morph alias of a given model at runtime using the <code
                                class=" language-php">getMorphClass</code> method. Conversely, you may determine the
                            fully-qualified class name associated with a morph alias using the <code
                                    class=" language-php">Relation<span class="token punctuation">:</span><span
                                    class="token punctuation">:</span>getMorphedModel</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Relations<span class="token punctuation">\</span>Relation</span><span
                                class="token punctuation">;</span>

<span class="token variable">$alias</span> <span class="token operator">=</span> <span
                                    class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">getMorphClass</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

<span class="token variable">$class</span> <span class="token operator">=</span> Relation<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">getMorphedModel</span><span
                                    class="token punctuation">(</span><span class="token variable">$alias</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="querying-relations"></a></p>
                        <h2 id="querying-relations"><a href="#querying-relations">Querying Relations</a></h2>
                        <p>Since all types of Eloquent relationships are defined via methods,
                            you may call those methods to obtain an instance of the relationship
                            without actually executing the relationship queries. In addition, all
                            types of Eloquent relationships also serve as <a
                                    href="https://laravel.com/docs/7.x/queries">query builders</a>,
                            allowing you to continue to chain constraints onto the relationship
                            query before finally executing the SQL against your database.</p>
                        <p>For example, imagine a blog system in which a <code class=" language-php">User</code> model
                            has many associated <code class=" language-php">Post</code> models:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get all of the posts for the user.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">posts</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hasMany</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>You may query the <code class=" language-php">posts</code> relationship and add additional
                            constraints to the relationship like so:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">posts</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">where</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'active'</span><span
                                    class="token punctuation">,</span> <span class="token number">1</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>You are able to use any of the <a href="https://laravel.com/docs/7.x/queries">query
                            builder</a>
                            methods on the relationship, so be sure to explore the query builder
                            documentation to learn about all of the methods that are available to
                            you.</p>
                        <h4>Chaining <code class=" language-php">orWhere</code> Clauses After Relationships</h4>
                        <p>As demonstrated in the example above, you are free to add additional
                            constraints to relationships when querying them. However, use caution
                            when chaining <code class=" language-php">orWhere</code> clauses onto a relationship, as the
                            <code class=" language-php">orWhere</code> clauses will be logically grouped at the same
                            level as the relationship constraint:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">posts</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">where</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'active'</span><span
                                    class="token punctuation">,</span> <span class="token number">1</span><span
                                    class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orWhere</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'votes'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'&gt;='</span><span
                                    class="token punctuation">,</span> <span class="token number">100</span><span
                                    class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// select * from posts</span>
<span class="token comment">// where user_id = ? and active = 1 or votes &gt;= 100</span></code></pre>
                        <p>In most situations, you likely intend to use <a
                                href="#parameter-grouping">constraint groups</a> to
                            logically group the conditional checks between parentheses:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">posts</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">where</span><span class="token punctuation">(</span><span
                                    class="token keyword">function</span> <span class="token punctuation">(</span>Builder <span
                                    class="token variable">$query</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$query</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">where</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'active'</span><span
                                    class="token punctuation">,</span> <span class="token number">1</span><span
                                    class="token punctuation">)</span>
                         <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">orWhere</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'votes'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'&gt;='</span><span
                                    class="token punctuation">,</span> <span class="token number">100</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// select * from posts</span>
<span class="token comment">// where user_id = ? and (active = 1 or votes &gt;= 100)</span></code></pre>
                        <p><a name="relationship-methods-vs-dynamic-properties"></a></p>
                        <h3 id="relationship-methods-vs-dynamic-properties"><a
                                href="#relationship-methods-vs-dynamic-properties">Relationship Methods Vs. Dynamic
                            Properties</a></h3>
                        <p>If you do not need to add additional constraints to an Eloquent
                            relationship query, you may access the relationship as if it were a
                            property. For example, continuing to use our <code class=" language-php">User</code> and
                            <code class=" language-php">Post</code> example models, we may access all of a user's posts
                            like so:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">posts</span> <span
                                    class="token keyword">as</span> <span class="token variable">$post</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Dynamic properties are "lazy loading", meaning they will only load
                            their relationship data when you actually access them. Because of this,
                            developers often use <a href="#eager-loading">eager loading</a> to
                            pre-load relationships they know will be accessed after loading the
                            model. Eager loading provides a significant reduction in SQL queries
                            that must be executed to load a model's relations.</p>
                        <p><a name="querying-relationship-existence"></a></p>
                        <h3 id="querying-relationship-existence"><a href="#querying-relationship-existence">Querying
                            Relationship Existence</a></h3>
                        <p>When accessing the records for a model, you may wish to limit your
                            results based on the existence of a relationship. For example, imagine
                            you want to retrieve all blog posts that have at least one comment. To
                            do so, you may pass the name of the relationship to the <code
                                    class=" language-php">has</code> and <code class=" language-php">orHas</code>
                            methods:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">// Retrieve all posts that have at least one comment...</span>
<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">has</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>You may also specify an operator and count to further customize the query:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">// Retrieve all posts that have three or more comments...</span>
<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">has</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'&gt;='</span><span
                                    class="token punctuation">,</span> <span class="token number">3</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>Nested <code class=" language-php">has</code> statements may also be
                            constructed using "dot" notation. For example, you may retrieve all
                            posts that have at least one comment and vote:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">// Retrieve posts that have at least one comment with votes...</span>
<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">has</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments.votes'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>If you need even more power, you may use the <code class=" language-php">whereHas</code> and
                            <code class=" language-php">orWhereHas</code> methods to put "where" conditions on your
                            <code class=" language-php">has</code>
                            queries. These methods allow you to add customized constraints to a
                            relationship constraint, such as checking the content of a comment:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token comment">// Retrieve posts with at least one comment containing words like foo%...</span>
<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">whereHas</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                    class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                    class="token punctuation">(</span>Builder <span class="token variable">$query</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'content'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Retrieve posts with at least ten comments containing words like foo%...</span>
<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">whereHas</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                    class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                    class="token punctuation">(</span>Builder <span class="token variable">$query</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'content'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span
                                    class="token single-quoted-string string">'&gt;='</span><span
                                    class="token punctuation">,</span> <span class="token number">10</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="querying-relationship-absence"></a></p>
                        <h3 id="querying-relationship-absence"><a href="#querying-relationship-absence">Querying
                            Relationship Absence</a></h3>
                        <p>When accessing the records for a model, you may wish to limit your
                            results based on the absence of a relationship. For example, imagine you
                            want to retrieve all blog posts that <strong>don't</strong> have any comments. To do so, you
                            may pass the name of the relationship to the <code class=" language-php">doesntHave</code>
                            and <code class=" language-php">orDoesntHave</code> methods:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                class="token package">Post</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">doesntHave</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p>If you need even more power, you may use the <code
                                class=" language-php">whereDoesntHave</code> and <code class=" language-php">orWhereDoesntHave</code>
                            methods to put "where" conditions on your <code class=" language-php">doesntHave</code>
                            queries. These methods allows you to add customized constraints to a
                            relationship constraint, such as checking the content of a comment:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span
                                    class="token function">whereDoesntHave</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                    class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                    class="token punctuation">(</span>Builder <span class="token variable">$query</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'content'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>You may use "dot" notation to execute a query against a nested
                            relationship. For example, the following query will retrieve all posts
                            with comments from authors that are not banned:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span
                                    class="token function">whereDoesntHave</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'comments.author'</span><span
                                    class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                    class="token punctuation">(</span>Builder <span class="token variable">$query</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'banned'</span><span
                                    class="token punctuation">,</span> <span class="token number">0</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="querying-polymorphic-relationships"></a></p>
                        <h3 id="querying-polymorphic-relationships"><a href="#querying-polymorphic-relationships">Querying
                            Polymorphic Relationships</a></h3>
                        <p>To query the existence of <code class=" language-php">MorphTo</code> relationships, you may
                            use the <code class=" language-php">whereHasMorph</code> method and its corresponding
                            methods:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token comment">// Retrieve comments associated to posts or videos with a title like foo%...</span>
<span class="token variable">$comments</span> <span class="token operator">=</span> App\<span class="token package">Comment</span><span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">whereHasMorph</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'commentable'</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'App\Video'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span>Builder <span
                                    class="token variable">$query</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
        <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'title'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

<span class="token comment">// Retrieve comments associated to posts with a title not like foo%...</span>
<span class="token variable">$comments</span> <span class="token operator">=</span> App\<span class="token package">Comment</span><span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">whereDoesntHaveMorph</span><span
                                    class="token punctuation">(</span>
    <span class="token single-quoted-string string">'commentable'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'App\Post'</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span>Builder <span
                                    class="token variable">$query</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
        <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'title'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>You may use the <code class=" language-php"><span class="token variable">$type</span></code>
                            parameter to add different constraints depending on the related model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$comments</span> <span class="token operator">=</span> App\<span class="token package">Comment</span><span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">whereHasMorph</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'commentable'</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'App\Video'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span>Builder <span
                                    class="token variable">$query</span><span class="token punctuation">,</span> <span
                                    class="token variable">$type</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
        <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'title'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span
                                    class="token variable">$type</span> <span class="token operator">===</span> <span
                                    class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">orWhere</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'content'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>Instead of passing an array of possible polymorphic models, you may provide <code
                                class=" language-php"><span class="token operator">*</span></code>
                            as a wildcard and let Laravel retrieve all the possible polymorphic
                            types from the database. Laravel will execute an additional query in
                            order to perform this operation:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$comments</span> <span class="token operator">=</span> App\<span class="token package">Comment</span><span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">whereHasMorph</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'commentable'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'*'</span><span
                                    class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                    class="token punctuation">(</span>Builder <span class="token variable">$query</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'title'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="counting-related-models"></a></p>
                        <h3 id="counting-related-models"><a href="#counting-related-models">Counting Related Models</a>
                        </h3>
                        <p>If you want to count the number of results from a relationship without actually loading them
                            you may use the <code class=" language-php">withCount</code> method, which will place a
                            <code class=" language-php"><span class="token punctuation">{</span>relation<span
                                    class="token punctuation">}</span>_count</code> column on your resulting models. For
                            example:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                class="token package">Post</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">withCount</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'comments'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$posts</span> <span class="token keyword">as</span> <span
                                    class="token variable">$post</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$post</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">comments_count</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>You may add the "counts" for multiple relations as well as add constraints to the
                            queries:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">withCount</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'votes'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'comments'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token keyword">function</span> <span class="token punctuation">(</span>Builder <span
                                    class="token variable">$query</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'content'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'foo%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token property">votes_count</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">comments_count</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>You may also alias the relationship count result, allowing multiple counts on the same
                            relationship:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Builder</span><span class="token punctuation">;</span>

<span class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">withCount</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'comments'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'comments as pending_comments_count'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token keyword">function</span> <span class="token punctuation">(</span>Builder <span
                                    class="token variable">$query</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
        <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'approved'</span><span
                                    class="token punctuation">,</span> <span class="token boolean constant">false</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">comments_count</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">pending_comments_count</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>If you're combining <code class=" language-php">withCount</code> with a <code
                                class=" language-php">select</code> statement, ensure that you call <code
                                class=" language-php">withCount</code> after the <code
                                class=" language-php">select</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$posts</span> <span class="token operator">=</span> App\<span
                                class="token package">Post</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">select</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'title'</span><span class="token punctuation">,</span> <span
                                class="token single-quoted-string string">'body'</span><span
                                class="token punctuation">]</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">withCount</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'comments'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">title</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">body</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$posts</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">comments_count</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>In addition, using the <code class=" language-php">loadCount</code> method, you may load a
                            relationship count after the parent model has already been retrieved:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$book</span> <span
                                class="token operator">=</span> App\<span class="token package">Book</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">first</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$book</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">loadCount</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'genres'</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>If you need to set additional query constraints on the eager loading
                            query, you may pass an array keyed by the relationships you wish to
                            load. The array values should be <code class=" language-php">Closure</code> instances which
                            receive the query builder instance:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$book</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">loadCount</span><span class="token punctuation">(</span><span
                                class="token punctuation">[</span><span class="token single-quoted-string string">'reviews'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token keyword">function</span> <span class="token punctuation">(</span><span
                                class="token variable">$query</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'rating'</span><span
                                    class="token punctuation">,</span> <span class="token number">5</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
                        <p><a name="eager-loading"></a></p>
                        <h2 id="eager-loading"><a href="#eager-loading">Eager Loading</a></h2>
                        <p>When accessing Eloquent relationships as properties, the relationship
                            data is "lazy loaded". This means the relationship data is not actually
                            loaded until you first access the property. However, Eloquent can
                            "eager load" relationships at the time you query the parent model. Eager
                            loading alleviates the N + 1 query problem. To illustrate the N + 1
                            query problem, consider a <code class=" language-php">Book</code> model that is related to
                            <code class=" language-php">Author</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Book</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the author that wrote the book.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">author</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">belongsTo</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Author'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Now, let's retrieve all books and their authors:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">all</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$books</span> <span class="token keyword">as</span> <span
                                    class="token variable">$book</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$book</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">author</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">name</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>This loop will execute 1 query to retrieve all of the books on the
                            table, then another query for each book to retrieve the author. So, if
                            we have 25 books, this loop would run 26 queries: 1 for the original
                            book, and 25 additional queries to retrieve the author of each book.</p>
                        <p>Thankfully, we can use eager loading to reduce this operation to just
                            2 queries. When querying, you may specify which relationships should be
                            eager loaded using the <code class=" language-php">with</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">with</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'author'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span
                                    class="token variable">$books</span> <span class="token keyword">as</span> <span
                                    class="token variable">$book</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable">$book</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">author</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">name</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>For this operation, only two queries will be executed:</p>
                        <pre class=" language-php"><code class=" language-php">select <span
                                class="token operator">*</span> from books

select <span class="token operator">*</span> from authors where id in <span class="token punctuation">(</span><span
                                    class="token number">1</span><span class="token punctuation">,</span> <span
                                    class="token number">2</span><span class="token punctuation">,</span> <span
                                    class="token number">3</span><span class="token punctuation">,</span> <span
                                    class="token number">4</span><span class="token punctuation">,</span> <span
                                    class="token number">5</span><span class="token punctuation">,</span> <span
                                    class="token punctuation">.</span><span class="token punctuation">.</span><span
                                    class="token punctuation">.</span><span
                                    class="token punctuation">)</span></code></pre>
                        <h4>Eager Loading Multiple Relationships</h4>
                        <p>Sometimes you may need to eager load several different relationships
                            in a single operation. To do so, just pass additional arguments to the <code
                                    class=" language-php">with</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">with</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'author'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'publisher'</span><span
                                class="token punctuation">]</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Nested Eager Loading</h4>
                        <p>To eager load nested relationships, you may use "dot" syntax. For
                            example, let's eager load all of the book's authors and all of the
                            author's personal contacts in one Eloquent statement:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">with</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'author.contacts'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <h4>Nested Eager Loading <code class=" language-php">morphTo</code> Relationships</h4>
                        <p>If you would like to eager load a <code class=" language-php">morphTo</code>
                            relationship, as well as nested relationships on the various entities
                            that may be returned by that relationship, you may use the <code
                                    class=" language-php">with</code> method in combination with the <code
                                    class=" language-php">morphTo</code> relationship's <code class=" language-php">morphWith</code>
                            method. To help illustrate this method, let's consider the following model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ActivityFeed</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the parent of the activity feed record.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">parentable</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphTo</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>In this example, let's assume <code class=" language-php">Event</code>, <code
                                class=" language-php">Photo</code>, and <code class=" language-php">Post</code> models
                            may create <code class=" language-php">ActivityFeed</code> models. Additionally, let's
                            assume that <code class=" language-php">Event</code> models belong to a <code
                                    class=" language-php">Calendar</code> model, <code
                                    class=" language-php">Photo</code> models are associated with <code
                                    class=" language-php">Tag</code> models, and <code class=" language-php">Post</code>
                            models belong to an <code class=" language-php">Author</code> model.</p>
                        <p>Using these model definitions and relationships, we may retrieve <code class=" language-php">ActivityFeed</code>
                            model instances and eager load all <code class=" language-php">parentable</code> models and
                            their respective nested relationships:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span
                                class="token punctuation">\</span>Relations<span class="token punctuation">\</span>MorphTo</span><span
                                class="token punctuation">;</span>

<span class="token variable">$activities</span> <span class="token operator">=</span> ActivityFeed<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">query</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">with</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span><span class="token single-quoted-string string">'parentable'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token keyword">function</span> <span class="token punctuation">(</span>MorphTo <span
                                    class="token variable">$morphTo</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
        <span class="token variable">$morphTo</span><span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">morphWith</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span>
            Event<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'calendar'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
            Photo<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'tags'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
            Post<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'author'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4>Eager Loading Specific Columns</h4>
                        <p>You may not always need every column from the relationships you are
                            retrieving. For this reason, Eloquent allows you to specify which
                            columns of the relationship you would like to retrieve:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">with</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'author:id,name'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="02-Relationships_files/exclamation.svg"></div>
                                <p class="content"> When using this feature, you should always include the <code
                                        class=" language-php">id</code> column and any relevant foreign key columns in
                                    the list of columns you wish to retrieve.</p></div>
                        </blockquote>
                        <h4>Eager Loading By Default</h4>
                        <p>Sometimes you might want to always load some relationships when retrieving a model. To
                            accomplish this, you may define a <code class=" language-php"><span class="token variable">$with</span></code>
                            property on the model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Book</span> <span
                                    class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The relationships that should always be loaded.
     *
     * @var array
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$with</span> <span class="token operator">=</span> <span
                                    class="token punctuation">[</span><span class="token single-quoted-string string">'author'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Get the author that wrote the book.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">author</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">belongsTo</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Author'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>If you would like to remove an item from the <code class=" language-php"><span
                                class="token variable">$with</span></code> property for a single query, you may use the
                            <code class=" language-php">without</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">without</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'author'</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p><a name="constraining-eager-loads"></a></p>
                        <h3 id="constraining-eager-loads"><a href="#constraining-eager-loads">Constraining Eager
                            Loads</a></h3>
                        <p>Sometimes you may wish to eager load a relationship, but also specify
                            additional query conditions for the eager loading query. Here's an
                            example:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$users</span> <span class="token operator">=</span> App\<span
                                class="token package">User</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">with</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'posts'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token keyword">function</span> <span class="token punctuation">(</span><span
                                class="token variable">$query</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'title'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'like'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'%first%'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>In this example, Eloquent will only eager load posts where the post's <code
                                class=" language-php">title</code> column contains the word <code class=" language-php">first</code>.
                            You may call other <a href="https://laravel.com/docs/7.x/queries">query builder</a> methods
                            to further customize the eager loading operation:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$users</span> <span class="token operator">=</span> App\<span
                                class="token package">User</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">with</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'posts'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token keyword">function</span> <span class="token punctuation">(</span><span
                                class="token variable">$query</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">orderBy</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'created_at'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'desc'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="02-Relationships_files/exclamation.svg"></div>
                                <p class="content"> The <code class=" language-php">limit</code> and <code
                                        class=" language-php">take</code> query builder methods may not be used when
                                    constraining eager loads.</p></div>
                        </blockquote>
                        <p><a name="lazy-eager-loading"></a></p>
                        <h3 id="lazy-eager-loading"><a href="#lazy-eager-loading">Lazy Eager Loading</a></h3>
                        <p>Sometimes you may need to eager load a relationship after the parent
                            model has already been retrieved. For example, this may be useful if you
                            need to dynamically decide whether to load related models:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$books</span> <span class="token operator">=</span> App\<span
                                class="token package">Book</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">all</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$someCondition</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$books</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">load</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'author'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'publisher'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>If you need to set additional query constraints on the eager loading
                            query, you may pass an array keyed by the relationships you wish to
                            load. The array values should be <code class=" language-php">Closure</code> instances which
                            receive the query instance:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$author</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">load</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'books'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token keyword">function</span> <span class="token punctuation">(</span><span
                                class="token variable">$query</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$query</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">orderBy</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'published_date'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'asc'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>To load a relationship only when it has not already been loaded, use the <code
                                class=" language-php">loadMissing</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">public</span> <span
                                class="token keyword">function</span> <span class="token function">format</span><span
                                class="token punctuation">(</span>Book <span class="token variable">$book</span><span
                                class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$book</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">loadMissing</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'author'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$book</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">name</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'author'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$book</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">author</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">name</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <h4>Nested Lazy Eager Loading &amp; <code class=" language-php">morphTo</code></h4>
                        <p>If you would like to eager load a <code class=" language-php">morphTo</code>
                            relationship, as well as nested relationships on the various entities
                            that may be returned by that relationship, you may use the <code class=" language-php">loadMorph</code>
                            method.</p>
                        <p>This method accepts the name of the <code class=" language-php">morphTo</code>
                            relationship as its first argument, and an array of model /
                            relationship pairs as its second argument. To help illustrate this
                            method, let's consider the following model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ActivityFeed</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the parent of the activity feed record.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">parentable</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">morphTo</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>In this example, let's assume <code class=" language-php">Event</code>, <code
                                class=" language-php">Photo</code>, and <code class=" language-php">Post</code> models
                            may create <code class=" language-php">ActivityFeed</code> models. Additionally, let's
                            assume that <code class=" language-php">Event</code> models belong to a <code
                                    class=" language-php">Calendar</code> model, <code
                                    class=" language-php">Photo</code> models are associated with <code
                                    class=" language-php">Tag</code> models, and <code class=" language-php">Post</code>
                            models belong to an <code class=" language-php">Author</code> model.</p>
                        <p>Using these model definitions and relationships, we may retrieve <code class=" language-php">ActivityFeed</code>
                            model instances and eager load all <code class=" language-php">parentable</code> models and
                            their respective nested relationships:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$activities</span> <span class="token operator">=</span> ActivityFeed<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">with</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'parentable'</span><span
                                class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">loadMorph</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'parentable'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span>
        Event<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'calendar'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
        Photo<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'tags'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
        Post<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">[</span><span class="token single-quoted-string string">'author'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="inserting-and-updating-related-models"></a></p>
                        <h2 id="inserting-and-updating-related-models"><a href="#inserting-and-updating-related-models">Inserting
                            &amp; Updating Related Models</a></h2>
                        <p><a name="the-save-method"></a></p>
                        <h3 id="the-save-method"><a href="#the-save-method">The Save Method</a></h3>
                        <p>Eloquent provides convenient methods for adding new models to relationships. For example,
                            perhaps you need to insert a new <code class=" language-php">Comment</code> for a <code
                                    class=" language-php">Post</code> model. Instead of manually setting the <code
                                    class=" language-php">post_id</code> attribute on the <code class=" language-php">Comment</code>,
                            you may insert the <code class=" language-php">Comment</code> directly from the
                            relationship's <code class=" language-php">save</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$comment</span> <span class="token operator">=</span> <span
                                class="token keyword">new</span> <span class="token class-name">App<span
                                class="token punctuation">\</span>Comment</span><span class="token punctuation">(</span><span
                                class="token punctuation">[</span><span class="token single-quoted-string string">'message'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token single-quoted-string string">'A new comment.'</span><span
                                class="token punctuation">]</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$post</span> <span class="token operator">=</span> App\<span
                                    class="token package">Post</span><span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">find</span><span
                                    class="token punctuation">(</span><span class="token number">1</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">save</span><span class="token punctuation">(</span><span
                                    class="token variable">$comment</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>Notice that we did not access the <code class=" language-php">comments</code> relationship as
                            a dynamic property. Instead, we called the <code class=" language-php">comments</code>
                            method to obtain an instance of the relationship. The <code
                                    class=" language-php">save</code> method will automatically add the appropriate
                            <code class=" language-php">post_id</code> value to the new <code class=" language-php">Comment</code>
                            model.</p>
                        <p>If you need to save multiple related models, you may use the <code class=" language-php">saveMany</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">saveMany</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">App<span class="token punctuation">\</span>Comment</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'message'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'A new comment.'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">App<span class="token punctuation">\</span>Comment</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'message'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'Another comment.'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="the-push-method"></a></p>
                        <h4 id="the-push-method"><a href="#the-push-method">Recursively Saving Models &amp;
                            Relationships</a></h4>
                        <p>If you would like to <code class=" language-php">save</code> your model and all of its
                            associated relationships, you may use the <code class=" language-php">push</code> method:
                        </p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">comments</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">message</span> <span
                                    class="token operator">=</span> <span class="token single-quoted-string string">'Message'</span><span
                                    class="token punctuation">;</span>
<span class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">comments</span><span
                                    class="token punctuation">[</span><span class="token number">0</span><span
                                    class="token punctuation">]</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">author</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">name</span> <span class="token operator">=</span> <span
                                    class="token single-quoted-string string">'Author Name'</span><span
                                    class="token punctuation">;</span>

<span class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">push</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="the-create-method"></a></p>
                        <h3 id="the-create-method"><a href="#the-create-method">The Create Method</a></h3>
                        <p>In addition to the <code class=" language-php">save</code> and <code class=" language-php">saveMany</code>
                            methods, you may also use the <code class=" language-php">create</code> method, which
                            accepts an array of attributes, creates a model, and inserts it into the database. Again,
                            the difference between <code class=" language-php">save</code> and <code
                                    class=" language-php">create</code> is that <code class=" language-php">save</code>
                            accepts a full Eloquent model instance while <code class=" language-php">create</code>
                            accepts a plain PHP <code class=" language-php"><span
                                    class="token keyword">array</span></code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$comment</span> <span class="token operator">=</span> <span
                                    class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">create</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span>
    <span class="token single-quoted-string string">'message'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'A new comment.'</span><span
                                    class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="02-Relationships_files/lightbulb.svg"></div>
                                <p class="content"> Before using the <code class=" language-php">create</code> method,
                                    be sure to review the documentation on attribute <a
                                            href="#mass-assignment">mass
                                        assignment</a>.</p></div>
                        </blockquote>
                        <p>You may use the <code class=" language-php">createMany</code> method to create multiple
                            related models:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$post</span> <span
                                class="token operator">=</span> App\<span class="token package">Post</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$post</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">comments</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">createMany</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'message'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'A new comment.'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'message'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'Another new comment.'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>You may also use the <code class=" language-php">findOrNew</code>, <code
                                class=" language-php">firstOrNew</code>, <code
                                class=" language-php">firstOrCreate</code> and <code class=" language-php">updateOrCreate</code>
                            methods to <a href="#other-creation-methods">create and
                                update models on relationships</a>.</p>
                        <p><a name="updating-belongs-to-relationships"></a></p>
                        <h3 id="updating-belongs-to-relationships"><a href="#updating-belongs-to-relationships">Belongs
                            To Relationships</a></h3>
                        <p>When updating a <code class=" language-php">belongsTo</code> relationship, you may use the
                            <code class=" language-php">associate</code> method. This method will set the foreign key on
                            the child model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$account</span> <span class="token operator">=</span> App\<span
                                class="token package">Account</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">10</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">account</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">associate</span><span class="token punctuation">(</span><span
                                    class="token variable">$account</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">save</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>When removing a <code class=" language-php">belongsTo</code> relationship, you may use the
                            <code class=" language-php">dissociate</code> method. This method will set the
                            relationship's foreign key to <code class=" language-php"><span
                                    class="token constant">null</span></code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">account</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">dissociate</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">save</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="default-models"></a></p>
                        <h4 id="default-models"><a href="#default-models">Default Models</a></h4>
                        <p>The <code class=" language-php">belongsTo</code>, <code class=" language-php">hasOne</code>,
                            <code class=" language-php">hasOneThrough</code>, and <code
                                    class=" language-php">morphOne</code> relationships allow you to define a default
                            model that will be returned if the given relationship is <code class=" language-php"><span
                                    class="token constant">null</span></code>. This pattern is often referred to as the
                            <a href="https://en.wikipedia.org/wiki/Null_Object_pattern">Null Object pattern</a> and can
                            help remove conditional checks in your code. In the following example, the <code
                                    class=" language-php">user</code> relation will return an empty <code
                                    class=" language-php">App\<span class="token package">User</span></code> model if no
                            <code class=" language-php">user</code> is attached to the post:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Get the author of the post.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">user</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">withDefault</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>To populate the default model with attributes, you may pass an array or Closure to the <code
                                class=" language-php">withDefault</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Get the author of the post.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">user</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">withDefault</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'Guest Author'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Get the author of the post.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">user</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">belongsTo</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'App\User'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">withDefault</span><span
                                    class="token punctuation">(</span><span class="token keyword">function</span> <span
                                    class="token punctuation">(</span><span class="token variable">$user</span><span
                                    class="token punctuation">,</span> <span class="token variable">$post</span><span
                                    class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">name</span> <span
                                    class="token operator">=</span> <span class="token single-quoted-string string">'Guest Author'</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="updating-many-to-many-relationships"></a></p>
                        <h3 id="updating-many-to-many-relationships"><a href="#updating-many-to-many-relationships">Many
                            To Many Relationships</a></h3>
                        <h4>Attaching / Detaching</h4>
                        <p>Eloquent also provides a few additional helper methods to make
                            working with related models more convenient. For example, let's imagine a
                            user can have many roles and a role can have many users. To attach a
                            role to a user by inserting a record in the intermediate table that
                            joins the models, use the <code class=" language-php">attach</code> method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">attach</span><span class="token punctuation">(</span><span
                                    class="token variable">$roleId</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>When attaching a relationship to a model, you may also pass an array
                            of additional data to be inserted into the intermediate table:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">roles</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">attach</span><span
                                class="token punctuation">(</span><span class="token variable">$roleId</span><span
                                class="token punctuation">,</span> <span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'expires'</span> <span class="token operator">=</span><span
                                class="token operator">&gt;</span> <span class="token variable">$expires</span><span
                                class="token punctuation">]</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p>Sometimes it may be necessary to remove a role from a user. To remove a many-to-many
                            relationship record, use the <code class=" language-php">detach</code> method. The <code
                                    class=" language-php">detach</code> method will delete the appropriate record out of
                            the intermediate table; however, both models will remain in the database:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">// Detach a single role from the user...</span>
<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">detach</span><span class="token punctuation">(</span><span
                                    class="token variable">$roleId</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

<span class="token comment">// Detach all roles from the user...</span>
<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">detach</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>For convenience, <code class=" language-php">attach</code> and <code class=" language-php">detach</code>
                            also accept arrays of IDs as input:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">detach</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span><span class="token number">1</span><span
                                    class="token punctuation">,</span> <span class="token number">2</span><span
                                    class="token punctuation">,</span> <span class="token number">3</span><span
                                    class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">attach</span><span class="token punctuation">(</span><span
                                    class="token punctuation">[</span>
    <span class="token number">1</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'expires'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token variable">$expires</span><span class="token punctuation">]</span><span
                                    class="token punctuation">,</span>
    <span class="token number">2</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'expires'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token variable">$expires</span><span class="token punctuation">]</span><span
                                    class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Syncing Associations</h4>
                        <p>You may also use the <code class=" language-php">sync</code> method to construct many-to-many
                            associations. The <code class=" language-php">sync</code>
                            method accepts an array of IDs to place on the intermediate table. Any
                            IDs that are not in the given array will be removed from the
                            intermediate table. So, after this operation is complete, only the IDs
                            in the given array will exist in the intermediate table:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">roles</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">sync</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token number">1</span><span class="token punctuation">,</span> <span
                                class="token number">2</span><span class="token punctuation">,</span> <span
                                class="token number">3</span><span class="token punctuation">]</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>You may also pass additional intermediate table values with the IDs:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">roles</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">sync</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token number">1</span> <span class="token operator">=</span><span
                                class="token operator">&gt;</span> <span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'expires'</span> <span class="token operator">=</span><span
                                class="token operator">&gt;</span> <span class="token boolean constant">true</span><span
                                class="token punctuation">]</span><span class="token punctuation">,</span> <span
                                class="token number">2</span><span class="token punctuation">,</span> <span
                                class="token number">3</span><span class="token punctuation">]</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>If you do not want to detach existing IDs, you may use the <code class=" language-php">syncWithoutDetaching</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">roles</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span
                                class="token function">syncWithoutDetaching</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token number">1</span><span class="token punctuation">,</span> <span
                                class="token number">2</span><span class="token punctuation">,</span> <span
                                class="token number">3</span><span class="token punctuation">]</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Toggling Associations</h4>
                        <p>The many-to-many relationship also provides a <code class=" language-php">toggle</code>
                            method which "toggles" the attachment status of the given IDs. If the
                            given ID is currently attached, it will be detached. Likewise, if it is
                            currently detached, it will be attached:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">roles</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">toggle</span><span
                                class="token punctuation">(</span><span class="token punctuation">[</span><span
                                class="token number">1</span><span class="token punctuation">,</span> <span
                                class="token number">2</span><span class="token punctuation">,</span> <span
                                class="token number">3</span><span class="token punctuation">]</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Saving Additional Data On A Pivot Table</h4>
                        <p>When working with a many-to-many relationship, the <code class=" language-php">save</code>
                            method accepts an array of additional intermediate table attributes as its second argument:
                        </p>
                        <pre class=" language-php"><code class=" language-php">App\<span
                                class="token package">User</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">roles</span><span
                                class="token punctuation">(</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token function">save</span><span class="token punctuation">(</span><span
                                class="token variable">$role</span><span class="token punctuation">,</span> <span
                                class="token punctuation">[</span><span class="token single-quoted-string string">'expires'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token variable">$expires</span><span class="token punctuation">]</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Updating A Record On A Pivot Table</h4>
                        <p>If you need to update an existing row in your pivot table, you may use <code
                                class=" language-php">updateExistingPivot</code> method. This method accepts the pivot
                            record foreign key and an array of attributes to update:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">roles</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">updateExistingPivot</span><span
                                    class="token punctuation">(</span><span class="token variable">$roleId</span><span
                                    class="token punctuation">,</span> <span
                                    class="token variable">$attributes</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="touching-parent-timestamps"></a></p>
                        <h2 id="touching-parent-timestamps"><a href="#touching-parent-timestamps">Touching Parent
                            Timestamps</a></h2>
                        <p>When a model <code class=" language-php">belongsTo</code> or <code class=" language-php">belongsToMany</code>
                            another model, such as a <code class=" language-php">Comment</code> which belongs to a <code
                                    class=" language-php">Post</code>, it is sometimes helpful to update the parent's
                            timestamp when the child model is updated. For example, when a <code class=" language-php">Comment</code>
                            model is updated, you may want to automatically "touch" the <code class=" language-php">updated_at</code>
                            timestamp of the owning <code class=" language-php">Post</code>. Eloquent makes it easy.
                            Just add a <code class=" language-php">touches</code> property containing the names of the
                            relationships to the child model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span
                                    class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Comment</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * All of the relationships to be touched.
     *
     * @var array
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$touches</span> <span
                                    class="token operator">=</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'post'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Get the post that the comment belongs to.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">belongsTo</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'App\Post'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Now, when you update a <code class=" language-php">Comment</code>, the owning <code
                                class=" language-php">Post</code> will have its <code
                                class=" language-php">updated_at</code> column updated as well, making it more
                            convenient to know when to invalidate a cache of the <code class=" language-php">Post</code>
                            model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$comment</span> <span class="token operator">=</span> App\<span
                                class="token package">Comment</span><span class="token punctuation">:</span><span
                                class="token punctuation">:</span><span class="token function">find</span><span
                                class="token punctuation">(</span><span class="token number">1</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$comment</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">text</span> <span
                                    class="token operator">=</span> <span class="token single-quoted-string string">'Edit to this comment!'</span><span
                                    class="token punctuation">;</span>

<span class="token variable">$comment</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">save</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                    </section>
                </section>
            </section>
        </div>
    </div>

</div>

</body>
<script src="../index_files/app.js.download"></script>
</html>