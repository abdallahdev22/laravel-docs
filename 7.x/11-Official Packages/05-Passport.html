<!DOCTYPE html>
<html class="gr__laravel_com" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Laravel Passport - Laravel - The PHP Framework For Web Artisans</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <link rel="canonical" href="https://laravel.com/docs/7.x/passport">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://laravel.com/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://laravel.com/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://laravel.com/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://laravel.com/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="https://laravel.com/img/favicon/safari-pinned-tab.svg" color="#ff2d20">
    <link rel="shortcut icon" href="https://laravel.com/img/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#ff2d20">
    <meta name="msapplication-config" content="/img/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Load fonts -->
    <link rel="stylesheet" href="05-Passport_files/ins2wgm.css">

    <!-- Load styles -->
    <link rel="stylesheet" type="text/css" href="05-Passport_files/app.css">

    <!-- Load JS -->
    <script src="05-Passport_files/jquery.js"></script>

    <script id="_carbonads_projs" type="text/javascript" src="05-Passport_files/CKYILK3E.json"></script>
</head>
<body class="language-php" data-gr-c-s-loaded="true">

<div class="sidebar_layout" id="docsScreen">

    <div class="page_contain">
        <div class="contain">
            <aside class="sidebar">
                <a href="../index.html" class="logo">
                    <img class="mark" src="../index_files/logomark.min.svg" alt="Laravel">
                    <img class="type" src="../index_files/logotype.min.svg" alt="Laravel">
                </a>
                <nav>
                    <div class="navigation_contain" style="display: block;">
                        <div class="docs_sidebar">
                            <ul>
                                <li>
                                    <h2>Prologue</h2>
                                    <ul>
                                        <li><a href="../01-Prologue/01-Release%20Notes.html">Release Notes</a></li>
                                        <li><a href="../01-Prologue/02-Upgrade%20Guide.html">Upgrade Guide</a></li>
                                        <li><a href="../01-Prologue/03-Contribution%20Guide.html">Contribution Guide</a>
                                        </li>
                                        <li><a href="https://laravel.com/api/7.x">API Documentation</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Getting Started</h2>
                                    <ul>
                                        <li><a href="../02-Getting%20Started/01-Installation.html">Installation</a></li>
                                        <li><a href="../02-Getting%20Started/02-Configuration.html">Configuration</a>
                                        </li>
                                        <li><a href="../02-Getting%20Started/03-Directory%20Structure.html">Directory
                                            Structure</a>
                                        </li>
                                        <li><a href="../02-Getting%20Started/04-Homestead.html">Homestead</a></li>
                                        <li><a href="../02-Getting%20Started/05-Valet.html">Valet</a></li>
                                        <li><a href="../02-Getting%20Started/06-Deployment.html">Deployment</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Architecture Concepts</h2>
                                    <ul>
                                        <li><a href="../03-Architecture%20Concepts/01-Request%20Lifecycle.html">Request
                                            Lifecycle</a></li>
                                        <li><a href="../03-Architecture%20Concepts/02-Service%20Container.html">Service
                                            Container</a></li>
                                        <li><a href="../03-Architecture%20Concepts/03-Service%20Providers.html">Service
                                            Providers</a></li>
                                        <li><a href="../03-Architecture%20Concepts/04-Facades.html">Facades</a></li>
                                        <li><a href="../03-Architecture%20Concepts/05-Contracts.html">Contracts</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>The Basics</h2>
                                    <ul>
                                        <li><a href="../04-The%20Basics/01-Routing.html">Routing</a></li>
                                        <li><a href="../04-The%20Basics/02-Middleware.html">Middleware</a></li>
                                        <li><a href="../04-The%20Basics/03-CSRF%20Protection.html">CSRF Protection</a>
                                        </li>
                                        <li><a href="../04-The%20Basics/04-Controllers.html">Controllers</a></li>
                                        <li><a href="../04-The%20Basics/05-Requests.html">Requests</a></li>
                                        <li><a href="../04-The%20Basics/06-Responses.html">Responses</a></li>
                                        <li><a href="../04-The%20Basics/07-Views.html">Views</a></li>
                                        <li><a href="../04-The%20Basics/08-URL%20Generation.html">URL Generation</a>
                                        </li>
                                        <li><a href="../04-The%20Basics/09-Session.html">Session</a></li>
                                        <li><a href="../04-The%20Basics/10-Validation.html">Validation</a></li>
                                        <li><a href="../04-The%20Basics/11-Error%20Handling.html">Error Handling</a>
                                        </li>
                                        <li><a href="../04-The%20Basics/12-Logging.html">Logging</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Frontend</h2>
                                    <ul>
                                        <li><a href="../05-Frontend/01-Blade%20Templates.html">Blade Templates</a></li>
                                        <li><a href="../05-Frontend/02-Localization.html">Localization</a></li>
                                        <li><a href="../05-Frontend/03-Frontend%20Scaffolding.html">Frontend
                                            Scaffolding</a></li>
                                        <li><a href="../05-Frontend/04-Compiling%20Assets.html">Compiling Assets</a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Security</h2>
                                    <ul>
                                        <li><a href="../06-Security/01-Authentication.html">Authentication</a></li>
                                        <li><a href="../06-Security/02-Authorization.html">Authorization</a></li>
                                        <li><a href="../06-Security/03-Email%20Verification.html">Email Verification</a>
                                        </li>
                                        <li><a href="../06-Security/04-Encryption.html">Encryption</a></li>
                                        <li><a href="../06-Security/05-Hashing.html">Hashing</a></li>
                                        <li><a href="../06-Security/06-Password%20Reset.html">Password Reset</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Digging Deeper</h2>
                                    <ul>
                                        <li><a href="../07-Digging%20Deeper/01-Artisan%20Console.html">Artisan
                                            Console</a></li>
                                        <li><a href="../07-Digging%20Deeper/02-Broadcasting.html">Broadcasting</a></li>
                                        <li><a href="../07-Digging%20Deeper/03-Cache.html">Cache</a></li>
                                        <li><a href="../07-Digging%20Deeper/04-Collections.html">Collections</a></li>
                                        <li><a href="../07-Digging%20Deeper/05-Events.html">Events</a></li>
                                        <li><a href="../07-Digging%20Deeper/06-File%20Storage.html">File Storage</a>
                                        </li>
                                        <li><a href="../07-Digging%20Deeper/07-Helpers.html">Helpers</a></li>
                                        <li><a href="../07-Digging%20Deeper/08-HTTP%20Client.html">HTTP Client</a></li>
                                        <li><a href="../07-Digging%20Deeper/09-Mail.html">Mail</a></li>
                                        <li><a href="../07-Digging%20Deeper/10-Notifications.html">Notifications</a>
                                        </li>
                                        <li><a href="../07-Digging%20Deeper/11-Package%20Development.html">Package
                                            Development</a>
                                        </li>
                                        <li><a href="../07-Digging%20Deeper/12-Queues.html">Queues</a></li>
                                        <li><a href="../07-Digging%20Deeper/13-Task%20Scheduling.html">Task
                                            Scheduling</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Database</h2>
                                    <ul>
                                        <li><a href="../08-Database/01-Getting%20Started.html">Getting Started</a></li>
                                        <li><a href="../08-Database/02-Query%20Builder.html">Query Builder</a></li>
                                        <li><a href="../08-Database/03-Pagination.html">Pagination</a></li>
                                        <li><a href="../08-Database/04-Migrations.html">Migrations</a></li>
                                        <li><a href="../08-Database/05-Seeding.html">Seeding</a></li>
                                        <li><a href="../08-Database/06-Redis.html">Redis</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Eloquent ORM</h2>
                                    <ul>
                                        <li><a href="../09-Eloquent%20ORM/01-Getting%20Started.html">Getting Started</a>
                                        </li>
                                        <li><a href="../09-Eloquent%20ORM/02-Relationships.html">Relationships</a></li>
                                        <li><a href="../09-Eloquent%20ORM/03-Collections.html">Collections</a></li>
                                        <li><a href="../09-Eloquent%20ORM/04-Mutators.html">Mutators</a></li>
                                        <li><a href="../09-Eloquent%20ORM/05-API%20Resources.html">API Resources</a>
                                        </li>
                                        <li><a href="../09-Eloquent%20ORM/06-Serialization.html">Serialization</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Testing</h2>
                                    <ul>
                                        <li><a href="../10-Testing/01-Getting%20Started.html">Getting Started</a></li>
                                        <li><a href="../10-Testing/02-HTTP%20Tests.html">HTTP Tests</a></li>
                                        <li><a href="../10-Testing/03-Console%20Tests.html">Console Tests</a></li>
                                        <li><a href="../10-Testing/04-Browser%20Tests.html">Browser Tests</a></li>
                                        <li><a href="../10-Testing/05-Database.html">Database</a></li>
                                        <li><a href="../10-Testing/06-Mocking.html">Mocking</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Official Packages</h2>
                                    <ul>
                                        <li><a href="../11-Official%20Packages/01-Cashier.html">Cashier (Stripe)</a>
                                        </li>
                                        <li><a href="https://github.com/laravel/cashier-mollie">Cashier (Mollie)</a>
                                        </li>
                                        <li><a href="../11-Official%20Packages/02-Dusk.html">Dusk</a></li>
                                        <li><a href="../11-Official%20Packages/03-Envoy.html">Envoy</a></li>
                                        <li><a href="../11-Official%20Packages/04-Horizon.html">Horizon</a></li>
                                        <li><a href="../11-Official%20Packages/05-Passport.html">Passport</a></li>
                                        <li><a href="../11-Official%20Packages/06-Sanctum.html">Sanctum</a></li>
                                        <li><a href="../11-Official%20Packages/07-Scout.html">Scout</a></li>
                                        <li><a href="../11-Official%20Packages/08-Socialite.html">Socialite</a></li>
                                        <li><a href="../11-Official%20Packages/09-Telescope.html">Telescope</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
                <div class="trigger_contain">
                    <a href="#" class="nav_trigger" aria-label="Menu">
                        <div class="bar"></div>
                    </a>
                </div>
            </aside>

            <section class="body_content">
                <section class="docs_body">
                    <section class="docs_main">
                        <h1>Laravel Passport</h1>
                        <ul>
                            <li><a href="#introduction">Introduction</a></li>
                            <li><a href="#upgrading">Upgrading Passport</a></li>
                            <li><a href="#installation">Installation</a>
                                <ul>
                                    <li><a href="#frontend-quickstart">Frontend Quickstart</a></li>
                                    <li><a href="#deploying-passport">Deploying Passport</a></li>
                                </ul>
                            </li>
                            <li><a href="#configuration">Configuration</a>
                                <ul>
                                    <li><a href="#token-lifetimes">Token Lifetimes</a></li>
                                    <li><a href="#overriding-default-models">Overriding Default Models</a></li>
                                </ul>
                            </li>
                            <li><a href="#issuing-access-tokens">Issuing Access Tokens</a>
                                <ul>
                                    <li><a href="#managing-clients">Managing Clients</a></li>
                                    <li><a href="#requesting-tokens">Requesting Tokens</a></li>
                                    <li><a href="#refreshing-tokens">Refreshing Tokens</a></li>
                                    <li><a href="#purging-tokens">Purging Tokens</a></li>
                                </ul>
                            </li>
                            <li><a href="#code-grant-pkce">Authorization Code Grant with PKCE</a>
                                <ul>
                                    <li><a href="#creating-a-auth-pkce-grant-client">Creating The Client</a></li>
                                    <li><a href="#requesting-auth-pkce-grant-tokens">Requesting Tokens</a></li>
                                </ul>
                            </li>
                            <li><a href="#password-grant-tokens">Password Grant Tokens</a>
                                <ul>
                                    <li><a href="#creating-a-password-grant-client">Creating A Password Grant Client</a>
                                    </li>
                                    <li><a href="#requesting-password-grant-tokens">Requesting Tokens</a></li>
                                    <li><a href="#requesting-all-scopes">Requesting All Scopes</a></li>
                                    <li><a href="#customizing-the-username-field">Customizing The Username Field</a>
                                    </li>
                                    <li><a href="#customizing-the-password-validation">Customizing The Password
                                        Validation</a></li>
                                </ul>
                            </li>
                            <li><a href="#implicit-grant-tokens">Implicit Grant Tokens</a></li>
                            <li><a href="#client-credentials-grant-tokens">Client Credentials Grant Tokens</a></li>
                            <li><a href="#personal-access-tokens">Personal Access Tokens</a>
                                <ul>
                                    <li><a href="#creating-a-personal-access-client">Creating A Personal Access
                                        Client</a></li>
                                    <li><a href="#managing-personal-access-tokens">Managing Personal Access Tokens</a>
                                    </li>
                                </ul>
                            </li>
                            <li><a href="#protecting-routes">Protecting Routes</a>
                                <ul>
                                    <li><a href="#via-middleware">Via Middleware</a></li>
                                    <li><a href="#passing-the-access-token">Passing The Access Token</a></li>
                                </ul>
                            </li>
                            <li><a href="#token-scopes">Token Scopes</a>
                                <ul>
                                    <li><a href="#defining-scopes">Defining Scopes</a></li>
                                    <li><a href="#default-scope">Default Scope</a></li>
                                    <li><a href="#assigning-scopes-to-tokens">Assigning Scopes To Tokens</a></li>
                                    <li><a href="#checking-scopes">Checking Scopes</a></li>
                                </ul>
                            </li>
                            <li><a href="#consuming-your-api-with-javascript">Consuming Your API With JavaScript</a>
                            </li>
                            <li><a href="#events">Events</a></li>
                            <li><a href="#testing">Testing</a></li>
                        </ul>
                        <p><a name="introduction"></a></p>
                        <h2 id="introduction"><a href="#introduction">Introduction</a></h2>
                        <p>Laravel already makes it easy to perform authentication via
                            traditional login forms, but what about APIs? APIs typically use tokens
                            to authenticate users and do not maintain session state between
                            requests. Laravel makes API authentication a breeze using Laravel
                            Passport, which provides a full OAuth2 server implementation for your
                            Laravel application in a matter of minutes. Passport is built on top of
                            the <a href="https://github.com/thephpleague/oauth2-server">League OAuth2 server</a> that is
                            maintained by Andy Millington and Simon Hamp.</p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="05-Passport_files/exclamation.svg"></div>
                                <p class="content">
                                    This documentation assumes you are already familiar with OAuth2. If you
                                    do not know anything about OAuth2, consider familiarizing yourself with
                                    the general <a href="https://oauth2.thephpleague.com/terminology/">terminology</a>
                                    and features of OAuth2 before continuing.</p></div>
                        </blockquote>
                        <p><a name="upgrading"></a></p>
                        <h2 id="upgrading"><a href="#upgrading">Upgrading Passport</a></h2>
                        <p>When upgrading to a new major version of Passport, it's important that you carefully review
                            <a href="https://github.com/laravel/passport/blob/master/UPGRADE.md">the upgrade guide</a>.
                        </p>
                        <p><a name="installation"></a></p>
                        <h2 id="installation"><a href="#installation">Installation</a></h2>
                        <p>To get started, install Passport via the Composer package manager:</p>
                        <pre class=" language-php"><code class=" language-php">composer <span class="token keyword">require</span> laravel<span
                                class="token operator">/</span>passport</code></pre>
                        <p>The Passport service provider registers its own database migration
                            directory with the framework, so you should migrate your database after
                            installing the package. The Passport migrations will create the tables
                            your application needs to store clients and access tokens:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan migrate</code></pre>
                        <p>Next, you should run the <code class=" language-php">passport<span class="token punctuation">:</span>install</code>
                            command. This command will create the encryption keys needed to
                            generate secure access tokens. In addition, the command will create
                            "personal access" and "password grant" clients which will be used to
                            generate access tokens:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>install</code></pre>
                        <p>After running this command, add the <code class=" language-php">Laravel\<span
                                class="token package">Passport<span
                                class="token punctuation">\</span>HasApiTokens</span></code> trait to your <code
                                class=" language-php">App\<span class="token package">User</span></code>
                            model. This trait will provide a few helper methods to your model which
                            allow you to inspect the authenticated user's token and scopes:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span
                                    class="token punctuation">\</span>Auth<span
                                    class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span
                                    class="token punctuation">\</span>Notifiable</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>HasApiTokens</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span
                                    class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HasApiTokens</span><span
                                    class="token punctuation">,</span> Notifiable<span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Next, you should call the <code class=" language-php">Passport<span
                                class="token punctuation">:</span><span class="token punctuation">:</span>routes</code>
                            method within the <code class=" language-php">boot</code> method of your <code
                                    class=" language-php">AuthServiceProvider</code>.
                            This method will register the routes necessary to issue access tokens
                            and revoke access tokens, clients, and personal access tokens:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Providers</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span
                                    class="token punctuation">\</span>Support<span class="token punctuation">\</span>Providers<span
                                    class="token punctuation">\</span>AuthServiceProvider</span> <span
                                    class="token keyword">as</span> ServiceProvider<span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span
                                    class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Gate</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>Passport</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AuthServiceProvider</span> <span
                                    class="token keyword">extends</span> <span
                                    class="token class-name">ServiceProvider</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The policy mappings for the application.
     *
     * @var array
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$policies</span> <span
                                    class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Model'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'App\Policies\ModelPolicy'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Register any authentication / authorization services.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

        Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p>Finally, in your <code class=" language-php">config<span
                                class="token operator">/</span>auth<span class="token punctuation">.</span>php</code>
                            configuration file, you should set the <code class=" language-php">driver</code> option of
                            the <code class=" language-php">api</code> authentication guard to <code
                                    class=" language-php">passport</code>. This will instruct your application to use
                            Passport's <code class=" language-php">TokenGuard</code> when authenticating incoming API
                            requests:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token single-quoted-string string">'guards'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token punctuation">[</span>
    <span class="token single-quoted-string string">'web'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'driver'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'session'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'provider'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'users'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'api'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'driver'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'passport'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'provider'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'users'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span></code></pre>
                        <h3>Migration Customization</h3>
                        <p>If you are not going to use Passport's default migrations, you should call the <code
                                class=" language-php">Passport<span class="token punctuation">:</span><span
                                class="token punctuation">:</span>ignoreMigrations</code> method in the <code
                                class=" language-php">register</code> method of your <code class=" language-php">AppServiceProvider</code>.
                            You may export the default migrations using <code class=" language-php">php artisan
                                vendor<span class="token punctuation">:</span>publish <span
                                        class="token operator">--</span>tag<span class="token operator">=</span>passport<span
                                        class="token operator">-</span>migrations</code>.</p>
                        <p>By default, Passport uses an integer column to store the <code
                                class=" language-php">user_id</code>.
                            If your application uses a different column type to identify users (for
                            example: UUIDs), you should modify the default Passport migrations
                            after publishing them.</p>
                        <p><a name="frontend-quickstart"></a></p>
                        <h3 id="frontend-quickstart"><a href="#frontend-quickstart">Frontend Quickstart</a></h3>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="05-Passport_files/exclamation.svg"></div>
                                <p class="content"> In order to use the Passport Vue components, you must be using the
                                    <a href="https://vuejs.org/">Vue</a>
                                    JavaScript framework. These components also use the Bootstrap CSS
                                    framework. However, even if you are not using these tools, the
                                    components serve as a valuable reference for your own frontend
                                    implementation.</p></div>
                        </blockquote>
                        <p>Passport ships with a JSON API that you may use to allow your users
                            to create clients and personal access tokens. However, it can be time
                            consuming to code a frontend to interact with these APIs. So, Passport
                            also includes pre-built <a href="https://vuejs.org/">Vue</a> components you may use as an
                            example implementation or starting point for your own implementation.</p>
                        <p>To publish the Passport Vue components, use the <code class=" language-php">vendor<span
                                class="token punctuation">:</span>publish</code> Artisan command:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan vendor<span
                                class="token punctuation">:</span>publish <span class="token operator">--</span>tag<span
                                class="token operator">=</span>passport<span
                                class="token operator">-</span>components</code></pre>
                        <p>The published components will be placed in your <code class=" language-php">resources<span
                                class="token operator">/</span>js<span class="token operator">/</span>components</code>
                            directory. Once the components have been published, you should register them in your <code
                                    class=" language-php">resources<span class="token operator">/</span>js<span
                                    class="token operator">/</span>app<span class="token punctuation">.</span>js</code>
                            file:</p>
                        <pre class=" language-php"><code class=" language-php">Vue<span
                                class="token punctuation">.</span><span class="token function">component</span><span
                                class="token punctuation">(</span>
    <span class="token single-quoted-string string">'passport-clients'</span><span class="token punctuation">,</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'./components/passport/Clients.vue'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">.</span><span
                                    class="token keyword">default</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'passport-authorized-clients'</span><span class="token punctuation">,</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'./components/passport/AuthorizedClients.vue'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">.</span><span
                                    class="token keyword">default</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>
    <span class="token single-quoted-string string">'passport-personal-access-tokens'</span><span
                                    class="token punctuation">,</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'./components/passport/PersonalAccessTokens.vue'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">.</span><span
                                    class="token keyword">default</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="05-Passport_files/exclamation.svg"></div>
                                <p class="content"> Prior to Laravel v5.7.19, appending <code
                                        class=" language-php"><span class="token punctuation">.</span><span
                                        class="token keyword">default</span></code> when registering components results
                                    in a console error. An explanation for this change can be found in the <a
                                            href="https://github.com/JeffreyWay/laravel-mix/releases/tag/v4.0.0">Laravel
                                        Mix v4.0.0 release notes</a>.</p></div>
                        </blockquote>
                        <p>After registering the components, make sure to run <code class=" language-php">npm run
                            dev</code>
                            to recompile your assets. Once you have recompiled your assets, you may
                            drop the components into one of your application's templates to get
                            started creating clients and personal access tokens:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token operator">&lt;</span>passport<span
                                class="token operator">-</span>clients<span class="token operator">&gt;</span><span
                                class="token operator">&lt;</span><span class="token operator">/</span>passport<span
                                class="token operator">-</span>clients<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>passport<span class="token operator">-</span>authorized<span
                                    class="token operator">-</span>clients<span class="token operator">&gt;</span><span
                                    class="token operator">&lt;</span><span class="token operator">/</span>passport<span
                                    class="token operator">-</span>authorized<span class="token operator">-</span>clients<span
                                    class="token operator">&gt;</span>
<span class="token operator">&lt;</span>passport<span class="token operator">-</span>personal<span
                                    class="token operator">-</span>access<span
                                    class="token operator">-</span>tokens<span class="token operator">&gt;</span><span
                                    class="token operator">&lt;</span><span class="token operator">/</span>passport<span
                                    class="token operator">-</span>personal<span
                                    class="token operator">-</span>access<span
                                    class="token operator">-</span>tokens<span class="token operator">&gt;</span></code></pre>
                        <p><a name="deploying-passport"></a></p>
                        <h3 id="deploying-passport"><a href="#deploying-passport">Deploying Passport</a></h3>
                        <p>When deploying Passport to your production servers for the first time, you will likely need
                            to run the <code class=" language-php">passport<span class="token punctuation">:</span>keys</code>
                            command. This command generates the encryption keys Passport needs in
                            order to generate access token. The generated keys are not typically
                            kept in source control:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>keys</code></pre>
                        <p>If necessary, you may define the path where Passport's keys should be loaded from. You may
                            use the <code class=" language-php">Passport<span class="token punctuation">:</span><span
                                    class="token punctuation">:</span>loadKeysFrom</code> method to accomplish this:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Register any authentication / authorization services.
 *
 * @return void
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">boot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">loadKeysFrom</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'/secret-keys/oauth'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Additionally, you may publish Passport's configuration file using <code
                                class=" language-php">php artisan vendor<span class="token punctuation">:</span>publish
                            <span class="token operator">--</span>tag<span class="token operator">=</span>passport<span
                                    class="token operator">-</span>config</code>, which will then provide the option to
                            load the encryption keys from your environment variables:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token constant">PASSPORT_PRIVATE_KEY</span><span
                                class="token operator">=</span><span class="token double-quoted-string string">"-----BEGIN RSA PRIVATE KEY-----
&lt;private key here&gt;
-----END RSA PRIVATE KEY-----"</span>

<span class="token constant">PASSPORT_PUBLIC_KEY</span><span class="token operator">=</span><span
                                    class="token double-quoted-string string">"-----BEGIN PUBLIC KEY-----
&lt;public key here&gt;
-----END PUBLIC KEY-----"</span></code></pre>
                        <p><a name="configuration"></a></p>
                        <h2 id="configuration"><a href="#configuration">Configuration</a></h2>
                        <p><a name="token-lifetimes"></a></p>
                        <h3 id="token-lifetimes"><a href="#token-lifetimes">Token Lifetimes</a></h3>
                        <p>By default, Passport issues long-lived access tokens that expire
                            after one year. If you would like to configure a longer / shorter token
                            lifetime, you may use the <code class=" language-php">tokensExpireIn</code>, <code
                                    class=" language-php">refreshTokensExpireIn</code>, and <code class=" language-php">personalAccessTokensExpireIn</code>
                            methods. These methods should be called from the <code class=" language-php">boot</code>
                            method of your <code class=" language-php">AuthServiceProvider</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Register any authentication / authorization services.
 *
 * @return void
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">boot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">tokensExpireIn</span><span class="token punctuation">(</span><span
                                    class="token function">now</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">addDays</span><span
                                    class="token punctuation">(</span><span class="token number">15</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">refreshTokensExpireIn</span><span
                                    class="token punctuation">(</span><span class="token function">now</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">addDays</span><span class="token punctuation">(</span><span
                                    class="token number">30</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">personalAccessTokensExpireIn</span><span
                                    class="token punctuation">(</span><span class="token function">now</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">addMonths</span><span class="token punctuation">(</span><span
                                    class="token number">6</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="overriding-default-models"></a></p>
                        <h3 id="overriding-default-models"><a href="#overriding-default-models">Overriding Default
                            Models</a></h3>
                        <p>You are free to extend the models used internally by Passport:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Laravel<span
                                class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Client</span> <span
                                class="token keyword">as</span> PassportClient<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">PassportClient</span>
<span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Then, you may instruct Passport to use your custom models via the <code
                                class=" language-php">Passport</code> class:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">App<span
                                class="token punctuation">\</span>Models<span class="token punctuation">\</span>Passport<span
                                class="token punctuation">\</span>AuthCode</span><span
                                class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span
                                    class="token punctuation">\</span>Models<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>Client</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span
                                    class="token punctuation">\</span>Models<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>PersonalAccessClient</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span
                                    class="token punctuation">\</span>Models<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>Token</span><span
                                    class="token punctuation">;</span>

<span class="token comment">/**
 * Register any authentication / authorization services.
 *
 * @return void
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">boot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">useTokenModel</span><span class="token punctuation">(</span>Token<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">useClientModel</span><span class="token punctuation">(</span>Client<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">useAuthCodeModel</span><span
                                    class="token punctuation">(</span>AuthCode<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">usePersonalAccessClientModel</span><span
                                    class="token punctuation">(</span>PersonalAccessClient<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="issuing-access-tokens"></a></p>
                        <h2 id="issuing-access-tokens"><a href="#issuing-access-tokens">Issuing Access Tokens</a></h2>
                        <p>Using OAuth2 with authorization codes is how most developers are
                            familiar with OAuth2. When using authorization codes, a client
                            application will redirect a user to your server where they will either
                            approve or deny the request to issue an access token to the client.</p>
                        <p><a name="managing-clients"></a></p>
                        <h3 id="managing-clients"><a href="#managing-clients">Managing Clients</a></h3>
                        <p>First, developers building applications that need to interact with
                            your application's API will need to register their application with
                            yours by creating a "client". Typically, this consists of providing the
                            name of their application and a URL that your application can redirect
                            to after users approve their request for authorization.</p>
                        <h4>The <code class=" language-php">passport<span
                                class="token punctuation">:</span>client</code> Command</h4>
                        <p>The simplest way to create a client is using the <code class=" language-php">passport<span
                                class="token punctuation">:</span>client</code> Artisan command. This command may be
                            used to create your own clients for testing your OAuth2 functionality. When you run the
                            <code class=" language-php">client</code> command, Passport will prompt you for more
                            information about your client and will provide you with a client ID and secret:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>client</code></pre>
                        <p><strong>Redirect URLs</strong></p>
                        <p>If you would like to whitelist multiple redirect URLs for your
                            client, you may specify them using a comma-delimited list when prompted
                            for the URL by the <code class=" language-php">passport<span
                                    class="token punctuation">:</span>client</code> command:</p>
                        <pre class=" language-php"><code class=" language-php">http<span
                                class="token punctuation">:</span><span class="token comment">//example.com/callback,http://examplefoo.com/callback</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="05-Passport_files/exclamation.svg"></div>
                                <p class="content"> Any URL which contains commas must be encoded.</p></div>
                        </blockquote>
                        <h4>JSON API</h4>
                        <p>Since your users will not be able to utilize the <code class=" language-php">client</code>
                            command, Passport provides a JSON API that you may use to create
                            clients. This saves you the trouble of having to manually code
                            controllers for creating, updating, and deleting clients.</p>
                        <p>However, you will need to pair Passport's JSON API with your own
                            frontend to provide a dashboard for your users to manage their clients.
                            Below, we'll review all of the API endpoints for managing clients. For
                            convenience, we'll use <a href="https://github.com/axios/axios">Axios</a> to demonstrate
                            making HTTP requests to the endpoints.</p>
                        <p>The JSON API is guarded by the <code class=" language-php">web</code> and <code
                                class=" language-php">auth</code> middleware; therefore, it may only be called from your
                            own application. It is not able to be called from an external source.</p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> If you don't want to implement the entire client management frontend
                                    yourself, you can use the <a href="#frontend-quickstart">frontend quickstart</a> to
                                    have a fully functional frontend in a matter of minutes.</p></div>
                        </blockquote>
                        <h4><code class=" language-php"><span class="token constant">GET</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>clients</code>
                        </h4>
                        <p>This route returns all of the clients for the authenticated user.
                            This is primarily useful for listing all of the user's clients so that
                            they may edit or delete them:</p>
                        <pre class=" language-php"><code class=" language-php">axios<span
                                class="token punctuation">.</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/clients'</span><span
                                class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4><code class=" language-php"><span class="token constant">POST</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>clients</code>
                        </h4>
                        <p>This route is used to create new clients. It requires two pieces of data: the client's <code
                                class=" language-php">name</code> and a <code class=" language-php">redirect</code> URL.
                            The <code class=" language-php">redirect</code> URL is where the user will be redirected
                            after approving or denying a request for authorization.</p>
                        <p>When a client is created, it will be issued a client ID and client
                            secret. These values will be used when requesting access tokens from
                            your application. The client creation route will return the new client
                            instance:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">const</span> data <span
                                class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span
                                    class="token single-quoted-string string">'Client Name'</span><span
                                    class="token punctuation">,</span>
    redirect<span class="token punctuation">:</span> <span class="token single-quoted-string string">'http://example.com/callback'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span><span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/clients'</span><span
                                    class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span> <span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        <span class="token comment">// List errors on response...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4><code class=" language-php"><span class="token constant">PUT</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>clients<span
                                class="token operator">/</span><span class="token punctuation">{</span>client<span
                                class="token operator">-</span>id<span class="token punctuation">}</span></code></h4>
                        <p>This route is used to update clients. It requires two pieces of data: the client's <code
                                class=" language-php">name</code> and a <code class=" language-php">redirect</code> URL.
                            The <code class=" language-php">redirect</code>
                            URL is where the user will be redirected after approving or denying a
                            request for authorization. The route will return the updated client
                            instance:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">const</span> data <span
                                class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span
                                    class="token single-quoted-string string">'New Client Name'</span><span
                                    class="token punctuation">,</span>
    redirect<span class="token punctuation">:</span> <span class="token single-quoted-string string">'http://example.com/callback'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span><span class="token function">put</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/clients/'</span> <span
                                    class="token operator">+</span> clientId<span class="token punctuation">,</span> data<span
                                    class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span> <span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        <span class="token comment">// List errors on response...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4><code class=" language-php"><span class="token constant">DELETE</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>clients<span
                                class="token operator">/</span><span class="token punctuation">{</span>client<span
                                class="token operator">-</span>id<span class="token punctuation">}</span></code></h4>
                        <p>This route is used to delete clients:</p>
                        <pre class=" language-php"><code class=" language-php">axios<span
                                class="token punctuation">.</span><span class="token function">delete</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/clients/'</span> <span
                                class="token operator">+</span> clientId<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="requesting-tokens"></a></p>
                        <h3 id="requesting-tokens"><a href="#requesting-tokens">Requesting Tokens</a></h3>
                        <h4>Redirecting For Authorization</h4>
                        <p>Once a client has been created, developers may use their client ID
                            and secret to request an authorization code and access token from your
                            application. First, the consuming application should make a redirect
                            request to your application's <code class=" language-php"><span
                                    class="token operator">/</span>oauth<span
                                    class="token operator">/</span>authorize</code> route like so:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/redirect'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">session</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'state'</span><span
                                    class="token punctuation">,</span> <span class="token variable">$state</span> <span
                                    class="token operator">=</span> Str<span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">random</span><span
                                    class="token punctuation">(</span><span class="token number">40</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token function">http_build_query</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'redirect_uri'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'http://example.com/callback'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'response_type'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'code'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">''</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'state'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$state</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/authorize?'</span><span
                                    class="token punctuation">.</span><span class="token variable">$query</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> Remember, the <code class=" language-php"><span
                                        class="token operator">/</span>oauth<span class="token operator">/</span>authorize</code>
                                    route is already defined by the <code class=" language-php">Passport<span
                                            class="token punctuation">:</span><span class="token punctuation">:</span>routes</code>
                                    method. You do not need to manually define this route.</p></div>
                        </blockquote>
                        <h4>Approving The Request</h4>
                        <p>When receiving authorization requests, Passport will automatically
                            display a template to the user allowing them to approve or deny the
                            authorization request. If they approve the request, they will be
                            redirected back to the <code class=" language-php">redirect_uri</code> that was specified by
                            the consuming application. The <code class=" language-php">redirect_uri</code> must match
                            the <code class=" language-php">redirect</code> URL that was specified when the client was
                            created.</p>
                        <p>If you would like to customize the authorization approval screen, you may publish Passport's
                            views using the <code class=" language-php">vendor<span class="token punctuation">:</span>publish</code>
                            Artisan command. The published views will be placed in <code class=" language-php">resources<span
                                    class="token operator">/</span>views<span class="token operator">/</span>vendor<span
                                    class="token operator">/</span>passport</code>:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan vendor<span
                                class="token punctuation">:</span>publish <span class="token operator">--</span>tag<span
                                class="token operator">=</span>passport<span class="token operator">-</span>views</code></pre>
                        <p>Sometimes you may wish to skip the authorization prompt, such as when
                            authorizing a first-party client. You may accomplish this by <a
                                    href="#overriding-default-models">extending the <code
                                    class=" language-php">Client</code> model</a> and defining a <code
                                    class=" language-php">skipsAuthorization</code> method. If <code
                                    class=" language-php">skipsAuthorization</code> returns <code class=" language-php"><span
                                    class="token boolean constant">true</span></code> the client will be approved and
                            the user will be redirected back to the <code class=" language-php">redirect_uri</code>
                            immediately:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Models<span
                                    class="token punctuation">\</span>Passport</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>Client</span> <span
                                    class="token keyword">as</span> BaseClient<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token keyword">extends</span> <span
                                    class="token class-name">BaseClient</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Determine if the client should skip the authorization prompt.
     *
     * @return bool
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">skipsAuthorization</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">firstParty</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <h4>Converting Authorization Codes To Access Tokens</h4>
                        <p>If the user approves the authorization request, they will be
                            redirected back to the consuming application. The consumer should first
                            verify the <code class=" language-php">state</code> parameter against the value that was
                            stored prior to the redirect. If the state parameter matches the consumer should issue a
                            <code class=" language-php"><span class="token constant">POST</span></code>
                            request to your application to request an access token. The request
                            should include the authorization code that was issued by your
                            application when the user approved the authorization request. In this
                            example, we'll use the Guzzle HTTP library to make the <code class=" language-php"><span
                                    class="token constant">POST</span></code> request:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/callback'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$state</span> <span class="token operator">=</span> <span class="token variable">$request</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">session</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">pull</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'state'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">throw_unless</span><span class="token punctuation">(</span>
        <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$state</span><span
                                    class="token punctuation">)</span> <span class="token operator">&gt;</span> <span
                                    class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span
                                    class="token variable">$state</span> <span class="token operator">===</span> <span
                                    class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">state</span><span
                                    class="token punctuation">,</span>
        InvalidArgumentException<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$http</span> <span class="token operator">=</span> <span
                                    class="token keyword">new</span> <span class="token class-name">GuzzleHttp<span
                                    class="token punctuation">\</span>Client</span><span
                                    class="token punctuation">;</span>

    <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$http</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">post</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'http://your-app.com/oauth/token'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'form_params'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'grant_type'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'authorization_code'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'client_id'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'client_secret'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-secret'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'redirect_uri'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'http://example.com/callback'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'code'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$request</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">code</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">json_decode</span><span
                                    class="token punctuation">(</span><span
                                    class="token punctuation">(</span>string<span
                                    class="token punctuation">)</span> <span
                                    class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">getBody</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>This <code class=" language-php"><span class="token operator">/</span>oauth<span
                                class="token operator">/</span>token</code> route will return a JSON response containing
                            <code class=" language-php">access_token</code>, <code
                                    class=" language-php">refresh_token</code>, and <code class=" language-php">expires_in</code>
                            attributes. The <code class=" language-php">expires_in</code> attribute contains the number
                            of seconds until the access token expires.</p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> Like the <code class=" language-php"><span
                                        class="token operator">/</span>oauth<span class="token operator">/</span>authorize</code>
                                    route, the <code class=" language-php"><span
                                            class="token operator">/</span>oauth<span class="token operator">/</span>token</code>
                                    route is defined for you by the <code class=" language-php">Passport<span
                                            class="token punctuation">:</span><span class="token punctuation">:</span>routes</code>
                                    method. There is no need to manually define this route. By default, this route is
                                    throttled using the settings of the <code
                                            class=" language-php">ThrottleRequests</code> middleware.</p></div>
                        </blockquote>
                        <p><a name="refreshing-tokens"></a></p>
                        <h3 id="refreshing-tokens"><a href="#refreshing-tokens">Refreshing Tokens</a></h3>
                        <p>If your application issues short-lived access tokens, users will need
                            to refresh their access tokens via the refresh token that was provided
                            to them when the access token was issued. In this example, we'll use the
                            Guzzle HTTP library to refresh the token:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$http</span> <span
                                class="token operator">=</span> <span class="token keyword">new</span> <span
                                class="token class-name">GuzzleHttp<span class="token punctuation">\</span>Client</span><span
                                class="token punctuation">;</span>

<span class="token variable">$response</span> <span class="token operator">=</span> <span
                                    class="token variable">$http</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/token'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'form_params'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'grant_type'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'refresh_token'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'refresh_token'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'the-refresh-token'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_secret'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'client-secret'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">''</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token function">json_decode</span><span
                                    class="token punctuation">(</span><span
                                    class="token punctuation">(</span>string<span
                                    class="token punctuation">)</span> <span
                                    class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">getBody</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>This <code class=" language-php"><span class="token operator">/</span>oauth<span
                                class="token operator">/</span>token</code> route will return a JSON response containing
                            <code class=" language-php">access_token</code>, <code
                                    class=" language-php">refresh_token</code>, and <code class=" language-php">expires_in</code>
                            attributes. The <code class=" language-php">expires_in</code> attribute contains the number
                            of seconds until the access token expires.</p>
                        <p><a name="purging-tokens"></a></p>
                        <h3 id="purging-tokens"><a href="#purging-tokens">Purging Tokens</a></h3>
                        <p>When tokens have been revoked or expired, you might want to purge
                            them from the database. Passport ships with a command that can do this
                            for you:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token shell-comment comment"># Purge revoked and expired tokens and auth codes...</span>
php artisan passport<span class="token punctuation">:</span>purge

<span class="token shell-comment comment"># Only purge revoked tokens and auth codes...</span>
php artisan passport<span class="token punctuation">:</span>purge <span class="token operator">--</span>revoked 

<span class="token shell-comment comment"># Only purge expired tokens and auth codes...</span>
php artisan passport<span class="token punctuation">:</span>purge <span
                                    class="token operator">--</span>expired</code></pre>
                        <p>You may also configure a <a href="https://laravel.com/docs/7.x/scheduling">scheduled job</a>
                            in your console <code class=" language-php">Kernel</code> class to automatically prune your
                            tokens on a schedule:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Define the application's command schedule.
 *
 * @param  \Illuminate\Console\Scheduling\Schedule  $schedule
 * @return void
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">schedule</span><span
                                    class="token punctuation">(</span>Schedule <span
                                    class="token variable">$schedule</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$schedule</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">command</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'passport:purge'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">hourly</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="code-grant-pkce"></a></p>
                        <h2 id="code-grant-pkce"><a href="#code-grant-pkce">Authorization Code Grant with PKCE</a></h2>
                        <p>The Authorization Code grant with "Proof Key for Code Exchange"
                            (PKCE) is a secure way to authenticate single page applications or
                            native applications to access your API. This grant should be used when
                            you can't guarantee that the client secret will be stored confidentially
                            or in order to mitigate the threat of having the authorization code
                            intercepted by an attacker. A combination of a "code verifier" and a
                            "code challenge" replaces the client secret when exchanging the
                            authorization code for an access token.</p>
                        <p><a name="creating-a-auth-pkce-grant-client"></a></p>
                        <h3 id="creating-a-auth-pkce-grant-client"><a href="#creating-a-auth-pkce-grant-client">Creating
                            The Client</a></h3>
                        <p>Before your application can issue tokens via the authorization code
                            grant with PKCE, you will need to create a PKCE-enabled client. You may
                            do this using the <code class=" language-php">passport<span
                                    class="token punctuation">:</span>client</code> command with the <code
                                    class=" language-php"><span class="token operator">--</span><span
                                    class="token keyword">public</span></code> option:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>client <span class="token operator">--</span><span
                                class="token keyword">public</span></code></pre>
                        <p><a name="requesting-auth-pkce-grant-tokens"></a></p>
                        <h3 id="requesting-auth-pkce-grant-tokens"><a href="#requesting-auth-pkce-grant-tokens">Requesting
                            Tokens</a></h3>
                        <h4>Code Verifier &amp; Code Challenge</h4>
                        <p>As this authorization grant does not provide a client secret,
                            developers will need to generate a combination of a code verifier and a
                            code challenge in order to request a token.</p>
                        <p>The code verifier should be a random string of between 43 and 128 characters containing
                            letters, numbers and <code class=" language-php"><span
                                    class="token double-quoted-string string">"-"</span></code>, <code
                                    class=" language-php"><span
                                    class="token double-quoted-string string">"."</span></code>, <code
                                    class=" language-php"><span
                                    class="token double-quoted-string string">"_"</span></code>, <code
                                    class=" language-php"><span
                                    class="token double-quoted-string string">"~"</span></code>, as defined in the <a
                                    href="https://tools.ietf.org/html/rfc7636">RFC 7636 specification</a>.</p>
                        <p>The code challenge should be a Base64 encoded string with URL and filename-safe characters.
                            The trailing <code class=" language-php"><span
                                    class="token single-quoted-string string">'='</span></code> characters should be
                            removed and no line breaks, whitespace, or other additional characters should be present.
                        </p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$encoded</span> <span class="token operator">=</span> <span
                                class="token function">base64_encode</span><span class="token punctuation">(</span><span
                                class="token function">hash</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'sha256'</span><span
                                class="token punctuation">,</span> <span
                                class="token variable">$code_verifier</span><span
                                class="token punctuation">,</span> <span class="token boolean constant">true</span><span
                                class="token punctuation">)</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token variable">$codeChallenge</span> <span class="token operator">=</span> <span class="token function">strtr</span><span
                                    class="token punctuation">(</span><span class="token function">rtrim</span><span
                                    class="token punctuation">(</span><span class="token variable">$encoded</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'='</span><span
                                    class="token punctuation">)</span><span class="token punctuation">,</span> <span
                                    class="token single-quoted-string string">'+/'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'-_'</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4>Redirecting For Authorization</h4>
                        <p>Once a client has been created, you may use the client ID and the
                            generated code verifier and code challenge to request an authorization
                            code and access token from your application. First, the consuming
                            application should make a redirect request to your application's <code
                                    class=" language-php"><span class="token operator">/</span>oauth<span
                                    class="token operator">/</span>authorize</code> route:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/redirect'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">session</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'state'</span><span
                                    class="token punctuation">,</span> <span class="token variable">$state</span> <span
                                    class="token operator">=</span> Str<span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">random</span><span
                                    class="token punctuation">(</span><span class="token number">40</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">session</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'code_verifier'</span><span
                                    class="token punctuation">,</span> <span
                                    class="token variable">$code_verifier</span> <span class="token operator">=</span> Str<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">random</span><span class="token punctuation">(</span><span
                                    class="token number">128</span><span class="token punctuation">)</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$codeChallenge</span> <span class="token operator">=</span> <span
                                    class="token function">strtr</span><span class="token punctuation">(</span><span
                                    class="token function">rtrim</span><span class="token punctuation">(</span>
        <span class="token function">base64_encode</span><span class="token punctuation">(</span><span
                                    class="token function">hash</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'sha256'</span><span
                                    class="token punctuation">,</span> <span
                                    class="token variable">$code_verifier</span><span class="token punctuation">,</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token single-quoted-string string">'='</span><span
                                    class="token punctuation">)</span><span class="token punctuation">,</span> <span
                                    class="token single-quoted-string string">'+/'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'-_'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token function">http_build_query</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'redirect_uri'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'http://example.com/callback'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'response_type'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'code'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">''</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'state'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$state</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'code_challenge'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token variable">$codeChallenge</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'code_challenge_method'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'S256'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/authorize?'</span><span
                                    class="token punctuation">.</span><span class="token variable">$query</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Converting Authorization Codes To Access Tokens</h4>
                        <p>If the user approves the authorization request, they will be
                            redirected back to the consuming application. The consumer should verify
                            the <code class=" language-php">state</code> parameter against the value that was stored
                            prior to the redirect, as in the standard Authorization Code Grant.</p>
                        <p>If the state parameter matches, the consumer should issue a <code class=" language-php"><span
                                class="token constant">POST</span></code>
                            request to your application to request an access token. The request
                            should include the authorization code that was issued by your
                            application when the user approved the authorization request along with
                            the originally generated code verifier:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/callback'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$state</span> <span class="token operator">=</span> <span class="token variable">$request</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">session</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">pull</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'state'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$codeVerifier</span> <span class="token operator">=</span> <span
                                    class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">session</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">pull</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'code_verifier'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">throw_unless</span><span class="token punctuation">(</span>
        <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$state</span><span
                                    class="token punctuation">)</span> <span class="token operator">&gt;</span> <span
                                    class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span
                                    class="token variable">$state</span> <span class="token operator">===</span> <span
                                    class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token property">state</span><span
                                    class="token punctuation">,</span>
        InvalidArgumentException<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span
                                    class="token keyword">new</span> <span class="token class-name">GuzzleHttp<span
                                    class="token punctuation">\</span>Client</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/token'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'form_params'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'grant_type'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'authorization_code'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'client_id'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'redirect_uri'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'http://example.com/callback'</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'code_verifier'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$codeVerifier</span><span
                                    class="token punctuation">,</span>
            <span class="token single-quoted-string string">'code'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$request</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">code</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">json_decode</span><span
                                    class="token punctuation">(</span><span
                                    class="token punctuation">(</span>string<span
                                    class="token punctuation">)</span> <span
                                    class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">getBody</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="password-grant-tokens"></a></p>
                        <h2 id="password-grant-tokens"><a href="#password-grant-tokens">Password Grant Tokens</a></h2>
                        <p>The OAuth2 password grant allows your other first-party clients, such
                            as a mobile application, to obtain an access token using an e-mail
                            address / username and password. This allows you to issue access tokens
                            securely to your first-party clients without requiring your users to go
                            through the entire OAuth2 authorization code redirect flow.</p>
                        <p><a name="creating-a-password-grant-client"></a></p>
                        <h3 id="creating-a-password-grant-client"><a href="#creating-a-password-grant-client">Creating A
                            Password Grant Client</a></h3>
                        <p>Before your application can issue tokens via the password grant, you
                            will need to create a password grant client. You may do this using the <code
                                    class=" language-php">passport<span class="token punctuation">:</span>client</code>
                            command with the <code class=" language-php"><span class="token operator">--</span>password</code>
                            option. If you have already run the <code class=" language-php">passport<span
                                    class="token punctuation">:</span>install</code> command, you do not need to run
                            this command:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>client <span class="token operator">--</span>password</code></pre>
                        <p><a name="requesting-password-grant-tokens"></a></p>
                        <h3 id="requesting-password-grant-tokens"><a href="#requesting-password-grant-tokens">Requesting
                            Tokens</a></h3>
                        <p>Once you have created a password grant client, you may request an access token by issuing a
                            <code class=" language-php"><span class="token constant">POST</span></code> request to the
                            <code class=" language-php"><span class="token operator">/</span>oauth<span
                                    class="token operator">/</span>token</code> route with the user's email address and
                            password. Remember, this route is already registered by the <code class=" language-php">Passport<span
                                    class="token punctuation">:</span><span
                                    class="token punctuation">:</span>routes</code> method so there is no need to define
                            it manually. If the request is successful, you will receive an <code class=" language-php">access_token</code>
                            and <code class=" language-php">refresh_token</code> in the JSON response from the server:
                        </p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$http</span> <span
                                class="token operator">=</span> <span class="token keyword">new</span> <span
                                class="token class-name">GuzzleHttp<span class="token punctuation">\</span>Client</span><span
                                class="token punctuation">;</span>

<span class="token variable">$response</span> <span class="token operator">=</span> <span
                                    class="token variable">$http</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/token'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'form_params'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'grant_type'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'password'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_secret'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'client-secret'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'username'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'taylor@laravel.com'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'my-password'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">''</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token function">json_decode</span><span
                                    class="token punctuation">(</span><span
                                    class="token punctuation">(</span>string<span
                                    class="token punctuation">)</span> <span
                                    class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">getBody</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> Remember, access tokens are long-lived by default. However, you are
                                    free to <a href="#configuration">configure your maximum access token lifetime</a> if
                                    needed.</p></div>
                        </blockquote>
                        <p><a name="requesting-all-scopes"></a></p>
                        <h3 id="requesting-all-scopes"><a href="#requesting-all-scopes">Requesting All Scopes</a></h3>
                        <p>When using the password grant or client credentials grant, you may
                            wish to authorize the token for all of the scopes supported by your
                            application. You can do this by requesting the <code class=" language-php"><span
                                    class="token operator">*</span></code> scope. If you request the <code
                                    class=" language-php"><span class="token operator">*</span></code> scope, the <code
                                    class=" language-php">can</code> method on the token instance will always return
                            <code class=" language-php"><span class="token boolean constant">true</span></code>. This
                            scope may only be assigned to a token that is issued using the <code class=" language-php">password</code>
                            or <code class=" language-php">client_credentials</code> grant:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$response</span> <span class="token operator">=</span> <span
                                class="token variable">$http</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">post</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/token'</span><span
                                class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'form_params'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'grant_type'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'password'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_secret'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'client-secret'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'username'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'taylor@laravel.com'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'my-password'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'*'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="customizing-the-username-field"></a></p>
                        <h3 id="customizing-the-username-field"><a href="#customizing-the-username-field">Customizing
                            The Username Field</a></h3>
                        <p>When authenticating using the password grant, Passport will use the <code
                                class=" language-php">email</code> attribute of your model as the "username". However,
                            you may customize this behavior by defining a <code
                                    class=" language-php">findForPassport</code> method on your model:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span
                                    class="token punctuation">\</span>Auth<span
                                    class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span
                                    class="token punctuation">\</span>Notifiable</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>HasApiTokens</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span
                                    class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HasApiTokens</span><span
                                    class="token punctuation">,</span> Notifiable<span
                                    class="token punctuation">;</span>

    <span class="token comment">/**
     * Find the user instance for the given username.
     *
     * @param  string  $username
     * @return \App\User
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">findForPassport</span><span
                                    class="token punctuation">(</span><span class="token variable">$username</span><span
                                    class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">where</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'username'</span><span
                                    class="token punctuation">,</span> <span
                                    class="token variable">$username</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">first</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p><a name="customizing-the-password-validation"></a></p>
                        <h3 id="customizing-the-password-validation"><a href="#customizing-the-password-validation">Customizing
                            The Password Validation</a></h3>
                        <p>When authenticating using the password grant, Passport will use the <code
                                class=" language-php">password</code> attribute of your model to validate the given
                            password. If your model does not have a <code class=" language-php">password</code>
                            attribute or you wish to customize the password validation logic, you can define a <code
                                    class=" language-php">validateForPassportPasswordGrant</code> method on your model:
                        </p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span
                                    class="token punctuation">\</span>Auth<span
                                    class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span
                                    class="token punctuation">\</span>Notifiable</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span
                                    class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Hash</span><span
                                    class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>HasApiTokens</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span
                                    class="token keyword">extends</span> <span
                                    class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HasApiTokens</span><span
                                    class="token punctuation">,</span> Notifiable<span
                                    class="token punctuation">;</span>

    <span class="token comment">/**
     * Validate the password of the user for the Passport password grant.
     *
     * @param  string  $password
     * @return bool
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">validateForPassportPasswordGrant</span><span
                                    class="token punctuation">(</span><span class="token variable">$password</span><span
                                    class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Hash<span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">check</span><span
                                    class="token punctuation">(</span><span class="token variable">$password</span><span
                                    class="token punctuation">,</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">password</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
                        <p><a name="implicit-grant-tokens"></a></p>
                        <h2 id="implicit-grant-tokens"><a href="#implicit-grant-tokens">Implicit Grant Tokens</a></h2>
                        <p>The implicit grant is similar to the authorization code grant;
                            however, the token is returned to the client without exchanging an
                            authorization code. This grant is most commonly used for JavaScript or
                            mobile applications where the client credentials can't be securely
                            stored. To enable the grant, call the <code class=" language-php">enableImplicitGrant</code>
                            method in your <code class=" language-php">AuthServiceProvider</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Register any authentication / authorization services.
 *
 * @return void
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">boot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">enableImplicitGrant</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Once a grant has been enabled, developers may use their client ID to
                            request an access token from your application. The consuming application
                            should make a redirect request to your application's <code class=" language-php"><span
                                    class="token operator">/</span>oauth<span
                                    class="token operator">/</span>authorize</code> route like so:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/redirect'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">session</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">put</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'state'</span><span
                                    class="token punctuation">,</span> <span class="token variable">$state</span> <span
                                    class="token operator">=</span> Str<span class="token punctuation">:</span><span
                                    class="token punctuation">:</span><span class="token function">random</span><span
                                    class="token punctuation">(</span><span class="token number">40</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token function">http_build_query</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'redirect_uri'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'http://example.com/callback'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'response_type'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'token'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">''</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'state'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token variable">$state</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/authorize?'</span><span
                                    class="token punctuation">.</span><span class="token variable">$query</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> Remember, the <code class=" language-php"><span
                                        class="token operator">/</span>oauth<span class="token operator">/</span>authorize</code>
                                    route is already defined by the <code class=" language-php">Passport<span
                                            class="token punctuation">:</span><span class="token punctuation">:</span>routes</code>
                                    method. You do not need to manually define this route.</p></div>
                        </blockquote>
                        <p><a name="client-credentials-grant-tokens"></a></p>
                        <h2 id="client-credentials-grant-tokens"><a href="#client-credentials-grant-tokens">Client
                            Credentials Grant Tokens</a></h2>
                        <p>The client credentials grant is suitable for machine-to-machine
                            authentication. For example, you might use this grant in a scheduled job
                            which is performing maintenance tasks over an API.</p>
                        <p>Before your application can issue tokens via the client credentials
                            grant, you will need to create a client credentials grant client. You
                            may do this using the <code class=" language-php"><span class="token operator">--</span>client</code>
                            option of the <code class=" language-php">passport<span class="token punctuation">:</span>client</code>
                            command:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>client <span
                                class="token operator">--</span>client</code></pre>
                        <p>Next, to use this grant type, you need to add the <code class=" language-php">CheckClientCredentials</code>
                            middleware to the <code class=" language-php"><span
                                    class="token variable">$routeMiddleware</span></code> property of your <code
                                    class=" language-php">app<span class="token operator">/</span>Http<span
                                    class="token operator">/</span>Kernel<span
                                    class="token punctuation">.</span>php</code> file:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Laravel<span
                                class="token punctuation">\</span>Passport<span
                                class="token punctuation">\</span>Http<span class="token punctuation">\</span>Middleware<span
                                class="token punctuation">\</span>CheckClientCredentials</span><span
                                class="token punctuation">;</span>

<span class="token keyword">protected</span> <span class="token variable">$routeMiddleware</span> <span
                                    class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'client'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> CheckClientCredentials<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
                        <p>Then, attach the middleware to a route:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/orders'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span
                                    class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">middleware</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'client'</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p>To restrict access to the route to specific scopes you may provide a
                            comma-delimited list of the required scopes when attaching the <code class=" language-php">client</code>
                            middleware to the route:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/orders'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span>Request <span
                                class="token variable">$request</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span
                                    class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">middleware</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'client:check-status,your-scope'</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h3>Retrieving Tokens</h3>
                        <p>To retrieve a token using this grant type, make a request to the <code class=" language-php">oauth<span
                                class="token operator">/</span>token</code> endpoint:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$guzzle</span> <span class="token operator">=</span> <span
                                class="token keyword">new</span> <span class="token class-name">GuzzleHttp<span
                                class="token punctuation">\</span>Client</span><span class="token punctuation">;</span>

<span class="token variable">$response</span> <span class="token operator">=</span> <span
                                    class="token variable">$guzzle</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/token'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'form_params'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'grant_type'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client_credentials'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'client_secret'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'client-secret'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'your-scope'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token function">json_decode</span><span
                                    class="token punctuation">(</span><span
                                    class="token punctuation">(</span>string<span
                                    class="token punctuation">)</span> <span
                                    class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">getBody</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">,</span> <span
                                    class="token boolean constant">true</span><span
                                    class="token punctuation">)</span><span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'access_token'</span><span
                                    class="token punctuation">]</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="personal-access-tokens"></a></p>
                        <h2 id="personal-access-tokens"><a href="#personal-access-tokens">Personal Access Tokens</a>
                        </h2>
                        <p>Sometimes, your users may want to issue access tokens to themselves
                            without going through the typical authorization code redirect flow.
                            Allowing users to issue tokens to themselves via your application's UI
                            can be useful for allowing users to experiment with your API or may
                            serve as a simpler approach to issuing access tokens in general.</p>
                        <p><a name="creating-a-personal-access-client"></a></p>
                        <h3 id="creating-a-personal-access-client"><a href="#creating-a-personal-access-client">Creating
                            A Personal Access Client</a></h3>
                        <p>Before your application can issue personal access tokens, you will
                            need to create a personal access client. You may do this using the <code
                                    class=" language-php">passport<span class="token punctuation">:</span>client</code>
                            command with the <code class=" language-php"><span class="token operator">--</span>personal</code>
                            option. If you have already run the <code class=" language-php">passport<span
                                    class="token punctuation">:</span>install</code> command, you do not need to run
                            this command:</p>
                        <pre class=" language-php"><code class=" language-php">php artisan passport<span
                                class="token punctuation">:</span>client <span class="token operator">--</span>personal</code></pre>
                        <p>If you have already defined a personal access client, you may instruct Passport to use it
                            using the <code class=" language-php">personalAccessClientId</code> method. Typically, this
                            method should be called from the <code class=" language-php">boot</code> method of your
                            <code class=" language-php">AuthServiceProvider</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Register any authentication / authorization services.
 *
 * @return void
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">boot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">personalAccessClientId</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p><a name="managing-personal-access-tokens"></a></p>
                        <h3 id="managing-personal-access-tokens"><a href="#managing-personal-access-tokens">Managing
                            Personal Access Tokens</a></h3>
                        <p>Once you have created a personal access client, you may issue tokens for a given user using
                            the <code class=" language-php">createToken</code> method on the <code
                                    class=" language-php">User</code> model instance. The <code class=" language-php">createToken</code>
                            method accepts the name of the token as its first argument and an optional array of <a
                                    href="#token-scopes">scopes</a> as its second argument:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token variable">$user</span> <span
                                class="token operator">=</span> App\<span class="token package">User</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">find</span><span class="token punctuation">(</span><span
                                class="token number">1</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span>

<span class="token comment">// Creating a token without scopes...</span>
<span class="token variable">$token</span> <span class="token operator">=</span> <span
                                    class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">createToken</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'Token Name'</span><span
                                    class="token punctuation">)</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token property">accessToken</span><span class="token punctuation">;</span>

<span class="token comment">// Creating a token with scopes...</span>
<span class="token variable">$token</span> <span class="token operator">=</span> <span
                                    class="token variable">$user</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">createToken</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'My Token'</span><span
                                    class="token punctuation">,</span> <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'place-orders'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token property">accessToken</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4>JSON API</h4>
                        <p>Passport also includes a JSON API for managing personal access
                            tokens. You may pair this with your own frontend to offer your users a
                            dashboard for managing personal access tokens. Below, we'll review all
                            of the API endpoints for managing personal access tokens. For
                            convenience, we'll use <a href="https://github.com/mzabriskie/axios">Axios</a> to
                            demonstrate making HTTP requests to the endpoints.</p>
                        <p>The JSON API is guarded by the <code class=" language-php">web</code> and <code
                                class=" language-php">auth</code> middleware; therefore, it may only be called from your
                            own application. It is not able to be called from an external source.</p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> If you don't want to implement the personal access token frontend
                                    yourself, you can use the <a href="#frontend-quickstart">frontend quickstart</a> to
                                    have a fully functional frontend in a matter of minutes.</p></div>
                        </blockquote>
                        <h4><code class=" language-php"><span class="token constant">GET</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>scopes</code>
                        </h4>
                        <p>This route returns all of the <a href="#token-scopes">scopes</a> defined for your
                            application. You may use this route to list the scopes a user may assign to a personal
                            access token:</p>
                        <pre class=" language-php"><code class=" language-php">axios<span
                                class="token punctuation">.</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/scopes'</span><span
                                class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4><code class=" language-php"><span class="token constant">GET</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>personal<span
                                class="token operator">-</span>access<span class="token operator">-</span>tokens</code>
                        </h4>
                        <p>This route returns all of the personal access tokens that the
                            authenticated user has created. This is primarily useful for listing all
                            of the user's tokens so that they may edit or delete them:</p>
                        <pre class=" language-php"><code class=" language-php">axios<span
                                class="token punctuation">.</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/personal-access-tokens'</span><span
                                class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4><code class=" language-php"><span class="token constant">POST</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>personal<span
                                class="token operator">-</span>access<span class="token operator">-</span>tokens</code>
                        </h4>
                        <p>This route creates new personal access tokens. It requires two pieces of data: the token's
                            <code class=" language-php">name</code> and the <code class=" language-php">scopes</code>
                            that should be assigned to the token:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token keyword">const</span> data <span
                                class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span
                                    class="token single-quoted-string string">'Token Name'</span><span
                                    class="token punctuation">,</span>
    scopes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span
                                    class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

axios<span class="token punctuation">.</span><span class="token function">post</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/personal-access-tokens'</span><span
                                    class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">.</span>accessToken<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token keyword">catch</span> <span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        <span class="token comment">// List errors on response...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4><code class=" language-php"><span class="token constant">DELETE</span> <span
                                class="token operator">/</span>oauth<span class="token operator">/</span>personal<span
                                class="token operator">-</span>access<span class="token operator">-</span>tokens<span
                                class="token operator">/</span><span class="token punctuation">{</span>token<span
                                class="token operator">-</span>id<span class="token punctuation">}</span></code></h4>
                        <p>This route may be used to delete personal access tokens:</p>
                        <pre class=" language-php"><code class=" language-php">axios<span
                                class="token punctuation">.</span><span class="token function">delete</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'/oauth/personal-access-tokens/'</span> <span
                                class="token operator">+</span> tokenId<span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p><a name="protecting-routes"></a></p>
                        <h2 id="protecting-routes"><a href="#protecting-routes">Protecting Routes</a></h2>
                        <p><a name="via-middleware"></a></p>
                        <h3 id="via-middleware"><a href="#via-middleware">Via Middleware</a></h3>
                        <p>Passport includes an <a
                                href="#adding-custom-guards">authentication
                            guard</a> that will validate access tokens on incoming requests. Once you have configured
                            the <code class=" language-php">api</code> guard to use the <code class=" language-php">passport</code>
                            driver, you only need to specify the <code class=" language-php">auth<span
                                    class="token punctuation">:</span>api</code> middleware on any routes that require a
                            valid access token:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/user'</span><span class="token punctuation">,</span> <span
                                class="token keyword">function</span> <span class="token punctuation">(</span><span
                                class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">middleware</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'auth:api'</span><span
                                    class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <p><a name="passing-the-access-token"></a></p>
                        <h3 id="passing-the-access-token"><a href="#passing-the-access-token">Passing The Access
                            Token</a></h3>
                        <p>When calling routes that are protected by Passport, your application's API consumers should
                            specify their access token as a <code class=" language-php">Bearer</code> token in the <code
                                    class=" language-php">Authorization</code> header of their request. For example,
                            when using the Guzzle HTTP library:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$response</span> <span class="token operator">=</span> <span
                                class="token variable">$client</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">request</span><span
                                class="token punctuation">(</span><span
                                class="token single-quoted-string string">'GET'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'/api/user'</span><span
                                class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'headers'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'Accept'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'application/json'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'Authorization'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'Bearer '</span><span
                                    class="token punctuation">.</span><span
                                    class="token variable">$accessToken</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="token-scopes"></a></p>
                        <h2 id="token-scopes"><a href="#token-scopes">Token Scopes</a></h2>
                        <p>Scopes allow your API clients to request a specific set of
                            permissions when requesting authorization to access an account. For
                            example, if you are building an e-commerce application, not all API
                            consumers will need the ability to place orders. Instead, you may allow
                            the consumers to only request authorization to access order shipment
                            statuses. In other words, scopes allow your application's users to limit
                            the actions a third-party application can perform on their behalf.</p>
                        <p><a name="defining-scopes"></a></p>
                        <h3 id="defining-scopes"><a href="#defining-scopes">Defining Scopes</a></h3>
                        <p>You may define your API's scopes using the <code class=" language-php">Passport<span
                                class="token punctuation">:</span><span
                                class="token punctuation">:</span>tokensCan</code> method in the <code
                                class=" language-php">boot</code> method of your <code class=" language-php">AuthServiceProvider</code>.
                            The <code class=" language-php">tokensCan</code>
                            method accepts an array of scope names and scope descriptions. The
                            scope description may be anything you wish and will be displayed to
                            users on the authorization approval screen:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Laravel<span
                                class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Passport</span><span
                                class="token punctuation">;</span>

Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">tokensCan</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'place-orders'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'Place orders'</span><span
                                    class="token punctuation">,</span>
    <span class="token single-quoted-string string">'check-status'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'Check order status'</span><span
                                    class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="default-scope"></a></p>
                        <h3 id="default-scope"><a href="#default-scope">Default Scope</a></h3>
                        <p>If a client does not request any specific scopes, you may configure
                            your Passport server to attach a default scope to the token using the <code
                                    class=" language-php">setDefaultScope</code> method. Typically, you should call this
                            method from the <code class=" language-php">boot</code> method of your <code
                                    class=" language-php">AuthServiceProvider</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Laravel<span
                                class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Passport</span><span
                                class="token punctuation">;</span>

Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDefaultScope</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'check-status'</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'place-orders'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="assigning-scopes-to-tokens"></a></p>
                        <h3 id="assigning-scopes-to-tokens"><a href="#assigning-scopes-to-tokens">Assigning Scopes To
                            Tokens</a></h3>
                        <h4>When Requesting Authorization Codes</h4>
                        <p>When requesting an access token using the authorization code grant, consumers should specify
                            their desired scopes as the <code class=" language-php">scope</code> query string parameter.
                            The <code class=" language-php">scope</code> parameter should be a space-delimited list of
                            scopes:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/redirect'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token function">http_build_query</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'client_id'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'client-id'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'redirect_uri'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'http://example.com/callback'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'response_type'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token single-quoted-string string">'code'</span><span
                                    class="token punctuation">,</span>
        <span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> <span class="token single-quoted-string string">'place-orders check-status'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">redirect</span><span
                                    class="token punctuation">(</span><span class="token single-quoted-string string">'http://your-app.com/oauth/authorize?'</span><span
                                    class="token punctuation">.</span><span class="token variable">$query</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>When Issuing Personal Access Tokens</h4>
                        <p>If you are issuing personal access tokens using the <code class=" language-php">User</code>
                            model's <code class=" language-php">createToken</code> method, you may pass the array of
                            desired scopes as the second argument to the method:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token variable">$token</span> <span class="token operator">=</span> <span
                                class="token variable">$user</span><span class="token operator">-</span><span
                                class="token operator">&gt;</span><span class="token function">createToken</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'My Token'</span><span
                                class="token punctuation">,</span> <span class="token punctuation">[</span><span
                                class="token single-quoted-string string">'place-orders'</span><span
                                class="token punctuation">]</span><span class="token punctuation">)</span><span
                                class="token operator">-</span><span class="token operator">&gt;</span><span
                                class="token property">accessToken</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="checking-scopes"></a></p>
                        <h3 id="checking-scopes"><a href="#checking-scopes">Checking Scopes</a></h3>
                        <p>Passport includes two middleware that may be used to verify that an
                            incoming request is authenticated with a token that has been granted a
                            given scope. To get started, add the following middleware to the <code
                                    class=" language-php"><span class="token variable">$routeMiddleware</span></code>
                            property of your <code class=" language-php">app<span
                                    class="token operator">/</span>Http<span class="token operator">/</span>Kernel<span
                                    class="token punctuation">.</span>php</code> file:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token single-quoted-string string">'scopes'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> \<span
                                class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                class="token punctuation">\</span>Http<span class="token punctuation">\</span>Middleware<span
                                class="token punctuation">\</span>CheckScopes</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token keyword">class</span><span class="token punctuation">,</span>
<span class="token single-quoted-string string">'scope'</span> <span class="token operator">=</span><span
                                    class="token operator">&gt;</span> \<span class="token package">Laravel<span
                                    class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Http<span
                                    class="token punctuation">\</span>Middleware<span class="token punctuation">\</span>CheckForAnyScope</span><span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span
                                    class="token punctuation">,</span></code></pre>
                        <h4>Check For All Scopes</h4>
                        <p>The <code class=" language-php">scopes</code> middleware may be assigned to a route to verify
                            that the incoming request's access token has <em>all</em> of the listed scopes:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/orders'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token comment">// Access token has both "check-status" and "place-orders" scopes...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">middleware</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'auth:api'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'scopes:check-status,place-orders'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4>Check For Any Scopes</h4>
                        <p>The <code class=" language-php">scope</code> middleware may be assigned to a route to verify
                            that the incoming request's access token has <em>at least one</em> of the listed scopes:</p>
                        <pre class=" language-php"><code class=" language-php">Route<span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">get</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'/orders'</span><span
                                class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                class="token punctuation">(</span><span class="token punctuation">)</span> <span
                                class="token punctuation">{</span>
    <span class="token comment">// Access token has either "check-status" or "place-orders" scope...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">middleware</span><span
                                    class="token punctuation">(</span><span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'auth:api'</span><span
                                    class="token punctuation">,</span> <span class="token single-quoted-string string">'scope:check-status,place-orders'</span><span
                                    class="token punctuation">]</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4>Checking Scopes On A Token Instance</h4>
                        <p>Once an access token authenticated request has entered your
                            application, you may still check if the token has a given scope using
                            the <code class=" language-php">tokenCan</code> method on the authenticated <code
                                    class=" language-php">User</code> instance:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Illuminate<span
                                class="token punctuation">\</span>Http<span
                                class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

Route<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'/orders'</span><span
                                    class="token punctuation">,</span> <span class="token keyword">function</span> <span
                                    class="token punctuation">(</span>Request <span
                                    class="token variable">$request</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span
                                    class="token variable">$request</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span class="token function">user</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">tokenCan</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'place-orders'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">)</span> <span
                                    class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <h4>Additional Scope Methods</h4>
                        <p>The <code class=" language-php">scopeIds</code> method will return an array of all defined
                            IDs / names:</p>
                        <pre class=" language-php"><code class=" language-php">Laravel\<span class="token package">Passport<span
                                class="token punctuation">\</span>Passport</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">scopeIds</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>The <code class=" language-php">scopes</code> method will return an array of all defined
                            scopes as instances of <code class=" language-php">Laravel\<span class="token package">Passport<span
                                    class="token punctuation">\</span>Scope</span></code>:</p>
                        <pre class=" language-php"><code class=" language-php">Laravel\<span class="token package">Passport<span
                                class="token punctuation">\</span>Passport</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">scopes</span><span class="token punctuation">(</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p>The <code class=" language-php">scopesFor</code> method will return an array of <code
                                class=" language-php">Laravel\<span class="token package">Passport<span
                                class="token punctuation">\</span>Scope</span></code> instances matching the given IDs /
                            names:</p>
                        <pre class=" language-php"><code class=" language-php">Laravel\<span class="token package">Passport<span
                                class="token punctuation">\</span>Passport</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">scopesFor</span><span class="token punctuation">(</span><span
                                class="token punctuation">[</span><span class="token single-quoted-string string">'place-orders'</span><span
                                class="token punctuation">,</span> <span class="token single-quoted-string string">'check-status'</span><span
                                class="token punctuation">]</span><span class="token punctuation">)</span><span
                                class="token punctuation">;</span></code></pre>
                        <p>You may determine if a given scope has been defined using the <code class=" language-php">hasScope</code>
                            method:</p>
                        <pre class=" language-php"><code class=" language-php">Laravel\<span class="token package">Passport<span
                                class="token punctuation">\</span>Passport</span><span
                                class="token punctuation">:</span><span class="token punctuation">:</span><span
                                class="token function">hasScope</span><span class="token punctuation">(</span><span
                                class="token single-quoted-string string">'place-orders'</span><span
                                class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="consuming-your-api-with-javascript"></a></p>
                        <h2 id="consuming-your-api-with-javascript"><a href="#consuming-your-api-with-javascript">Consuming
                            Your API With JavaScript</a></h2>
                        <p>When building an API, it can be extremely useful to be able to
                            consume your own API from your JavaScript application. This approach to
                            API development allows your own application to consume the same API that
                            you are sharing with the world. The same API may be consumed by your
                            web application, mobile applications, third-party applications, and any
                            SDKs that you may publish on various package managers.</p>
                        <p>Typically, if you want to consume your API from your JavaScript
                            application, you would need to manually send an access token to the
                            application and pass it with each request to your application. However,
                            Passport includes a middleware that can handle this for you. All you
                            need to do is add the <code class=" language-php">CreateFreshApiToken</code> middleware to
                            your <code class=" language-php">web</code> middleware group in your <code
                                    class=" language-php">app<span class="token operator">/</span>Http<span
                                    class="token operator">/</span>Kernel<span
                                    class="token punctuation">.</span>php</code> file:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token single-quoted-string string">'web'</span> <span
                                class="token operator">=</span><span class="token operator">&gt;</span> <span
                                class="token punctuation">[</span>
    <span class="token comment">// Other middleware...</span>
    \<span class="token package">Laravel<span class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Http<span
                                    class="token punctuation">\</span>Middleware<span class="token punctuation">\</span>CreateFreshApiToken</span><span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span></code></pre>
                        <blockquote>
                            <div class="callout">
                                <div class="icon red"><img src="05-Passport_files/exclamation.svg"></div>
                                <p class="content"> You should ensure that the <code class=" language-php">CreateFreshApiToken</code>
                                    middleware is the last middleware listed in your middleware stack.</p></div>
                        </blockquote>
                        <p>This Passport middleware will attach a <code class=" language-php">laravel_token</code>
                            cookie to your outgoing responses. This cookie contains an encrypted
                            JWT that Passport will use to authenticate API requests from your
                            JavaScript application. Now, you may make requests to your application's
                            API without explicitly passing an access token:</p>
                        <pre class=" language-php"><code class=" language-php">axios<span
                                class="token punctuation">.</span><span class="token function">get</span><span
                                class="token punctuation">(</span><span class="token single-quoted-string string">'/api/user'</span><span
                                class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span
                                    class="token punctuation">(</span>response <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span
                                    class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span></code></pre>
                        <h4>Customizing The Cookie Name</h4>
                        <p>If needed, you can customize the <code class=" language-php">laravel_token</code> cookie's
                            name using the <code class=" language-php">Passport<span
                                    class="token punctuation">:</span><span
                                    class="token punctuation">:</span>cookie</code> method. Typically, this method
                            should be called from the <code class=" language-php">boot</code> method of your <code
                                    class=" language-php">AuthServiceProvider</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * Register any authentication / authorization services.
 *
 * @return void
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span
                                    class="token function">boot</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">registerPolicies</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span><span
                                    class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">routes</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">cookie</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'custom_name'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <h4>CSRF Protection</h4>
                        <p>When using this method of authentication, you will need to ensure a
                            valid CSRF token header is included in your requests. The default
                            Laravel JavaScript scaffolding includes an Axios instance, which will
                            automatically use the encrypted <code class=" language-php"><span class="token constant">XSRF</span><span
                                    class="token operator">-</span><span class="token constant">TOKEN</span></code>
                            cookie value to send a <code class=" language-php"><span
                                    class="token constant">X</span><span class="token operator">-</span><span
                                    class="token constant">XSRF</span><span class="token operator">-</span><span
                                    class="token constant">TOKEN</span></code> header on same-origin requests.</p>
                        <blockquote>
                            <div class="callout">
                                <div class="icon purple"><img src="05-Passport_files/lightbulb.svg"></div>
                                <p class="content"> If you choose to send the <code class=" language-php"><span
                                        class="token constant">X</span><span class="token operator">-</span><span
                                        class="token constant">CSRF</span><span class="token operator">-</span><span
                                        class="token constant">TOKEN</span></code> header instead of <code
                                        class=" language-php"><span class="token constant">X</span><span
                                        class="token operator">-</span><span class="token constant">XSRF</span><span
                                        class="token operator">-</span><span class="token constant">TOKEN</span></code>,
                                    you will need to use the unencrypted token provided by <code
                                            class=" language-php"><span class="token function">csrf_token</span><span
                                            class="token punctuation">(</span><span
                                            class="token punctuation">)</span></code>.</p></div>
                        </blockquote>
                        <p><a name="events"></a></p>
                        <h2 id="events"><a href="#events">Events</a></h2>
                        <p>Passport raises events when issuing access tokens and refresh tokens.
                            You may use these events to prune or revoke other access tokens in your
                            database. You may attach listeners to these events in your
                            application's <code class=" language-php">EventServiceProvider</code>:</p>
                        <pre class=" language-php"><code class=" language-php"><span class="token comment">/**
 * The event listener mappings for the application.
 *
 * @var array
 */</span>
<span class="token keyword">protected</span> <span class="token variable">$listen</span> <span
                                    class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'Laravel\Passport\Events\AccessTokenCreated'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\RevokeOldTokens'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'Laravel\Passport\Events\RefreshTokenCreated'</span> <span
                                    class="token operator">=</span><span class="token operator">&gt;</span> <span
                                    class="token punctuation">[</span>
        <span class="token single-quoted-string string">'App\Listeners\PruneOldTokens'</span><span
                                    class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
                        <p><a name="testing"></a></p>
                        <h2 id="testing"><a href="#testing">Testing</a></h2>
                        <p>Passport's <code class=" language-php">actingAs</code> method may be used to specify the
                            currently authenticated user as well as its scopes. The first argument given to the <code
                                    class=" language-php">actingAs</code> method is the user instance and the second is
                            an array of scopes that should be granted to the user's token:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">App<span
                                class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>Passport</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testServerCreation</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">actingAs</span><span class="token punctuation">(</span>
        <span class="token function">factory</span><span class="token punctuation">(</span>User<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">create</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'create-servers'</span><span
                                    class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">post</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'/api/create-server'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">assertStatus</span><span
                                    class="token punctuation">(</span><span class="token number">201</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                        <p>Passport's <code class=" language-php">actingAsClient</code> method may be used to specify
                            the currently authenticated client as well as its scopes. The first argument given to the
                            <code class=" language-php">actingAsClient</code> method is the client instance and the
                            second is an array of scopes that should be granted to the client's token:</p>
                        <pre class=" language-php"><code class=" language-php"><span
                                class="token keyword">use</span> <span class="token package">Laravel<span
                                class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Client</span><span
                                class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span
                                    class="token punctuation">\</span>Passport</span><span
                                    class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testGetOrders</span><span
                                    class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Passport<span class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token function">actingAsClient</span><span class="token punctuation">(</span>
        <span class="token function">factory</span><span class="token punctuation">(</span>Client<span
                                    class="token punctuation">:</span><span class="token punctuation">:</span><span
                                    class="token keyword">class</span><span class="token punctuation">)</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">create</span><span class="token punctuation">(</span><span
                                    class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span
                                    class="token single-quoted-string string">'check-status'</span><span
                                    class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$this</span><span
                                    class="token operator">-</span><span class="token operator">&gt;</span><span
                                    class="token function">get</span><span class="token punctuation">(</span><span
                                    class="token single-quoted-string string">'/api/orders'</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$response</span><span class="token operator">-</span><span
                                    class="token operator">&gt;</span><span
                                    class="token function">assertStatus</span><span
                                    class="token punctuation">(</span><span class="token number">200</span><span
                                    class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                    </section>
                </section>
            </section>
        </div>
    </div>

</div>

</body>
<script src="../index_files/app.js.download"></script>
</html>